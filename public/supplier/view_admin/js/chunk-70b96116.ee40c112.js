(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70b96116"],{3353:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"ivu-mts",staticStyle:{"padding-bottom":"0"},attrs:{bordered:!1,"dis-hover":""}},[a("div",{staticClass:"new_card_pd"},[a("Form",{ref:"pagination",attrs:{inline:"",model:t.pagination,"label-width":t.labelWidth,"label-position":t.labelPosition},nativeOn:{submit:function(t){t.preventDefault()}}},[a("FormItem",{attrs:{label:"退款时间："}},[a("DatePicker",{staticClass:"mr20",staticStyle:{width:"250px"},attrs:{editable:!1,value:t.timeVal,format:"yyyy/MM/dd",type:"daterange",placement:"bottom-start",placeholder:"自定义时间",options:t.options},on:{"on-change":t.onchangeTime}})],1),a("FormItem",{attrs:{label:"售后类型："}},[a("Select",{staticClass:"input-add",attrs:{clearable:""},on:{"on-change":t.orderSearch},model:{value:t.pagination.apply_type,callback:function(e){t.$set(t.pagination,"apply_type",e)},expression:"pagination.apply_type"}},[a("Option",{attrs:{value:1}},[t._v("仅退款")]),a("Option",{attrs:{value:2}},[t._v("退货退款(快递退回)")]),a("Option",{attrs:{value:3}},[t._v("退货退款(到店退货)")]),a("Option",{attrs:{value:4}},[t._v("平台退款")])],1)],1),a("FormItem",{attrs:{label:"处理状态："}},[a("Select",{staticClass:"input-add",attrs:{clearable:""},on:{"on-change":t.orderSearch},model:{value:t.pagination.refund_type,callback:function(e){t.$set(t.pagination,"refund_type",e)},expression:"pagination.refund_type"}},[a("Option",{attrs:{value:0}},[t._v("待处理")]),a("Option",{attrs:{value:1}},[t._v("仅退款")]),a("Option",{attrs:{value:2}},[t._v("退货退款")]),a("Option",{attrs:{value:3}},[t._v("拒绝退款")]),a("Option",{attrs:{value:4}},[t._v("同意退货")]),a("Option",{attrs:{value:5}},[t._v("已退货")]),a("Option",{attrs:{value:6}},[t._v("已退款")])],1)],1),a("FormItem",{attrs:{label:"售后原因："}},[a("Select",{staticClass:"input-add",attrs:{clearable:""},on:{"on-change":t.orderSearch},model:{value:t.pagination.refund_reason,callback:function(e){t.$set(t.pagination,"refund_reason",e)},expression:"pagination.refund_reason"}},t._l(t.reasonList,(function(e,r){return a("Option",{key:r,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("FormItem",{attrs:{label:"订单搜索：","label-for":"title"}},[a("Input",{staticStyle:{width:"250px","margin-right":"14px"},attrs:{placeholder:"请输入订单号"},model:{value:t.pagination.order_id,callback:function(e){t.$set(t.pagination,"order_id",e)},expression:"pagination.order_id"}}),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.orderSearch()}}},[t._v("查询")]),a("Button",{staticClass:"ml20",on:{click:t.reset}},[t._v("重置")])],1)],1)],1)]),a("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[a("Table",{ref:"table",attrs:{columns:t.thead,data:t.tbody,loading:t.loading,"highlight-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"},scopedSlots:t._u([{key:"order_id",fn:function(e){var r=e.row;return[a("span",{staticStyle:{display:"block"},domProps:{textContent:t._s(r.order_id)}}),a("span",{directives:[{name:"show",rawName:"v-show",value:1===r.is_del&&null==r.delete_time,expression:"row.is_del === 1 && row.delete_time == null"}],staticStyle:{color:"#ed4014",display:"block"}},[t._v("用户已删除")])]}},{key:"nickname",fn:function(e){var r=e.row;return[a("div",[t._v(t._s(r.nickname)),null!=r.delete_time?a("span",{staticStyle:{color:"#ed4014"}},[t._v(" (已注销)")]):t._e()])]}},{key:"user",fn:function(e){var r=e.row;return[a("div",[t._v("用户名："+t._s(r.nickname))]),a("div",[t._v("用户ID："+t._s(r.uid))])]}},{key:"apply_type",fn:function(e){var r=e.row;return[1==r.apply_type?a("Tag",{attrs:{color:"blue",size:"medium"}},[t._v("仅退款")]):t._e(),2==r.apply_type?a("Tag",{attrs:{color:"blue",size:"medium"}},[t._v("退货退款(快递退回)")]):t._e(),3==r.apply_type?a("Tag",{attrs:{color:"blue",size:"medium"}},[t._v("退货退款(到店退货)")]):t._e(),4==r.apply_type?a("Tag",{attrs:{color:"blue",size:"medium"}},[t._v("平台退款")]):t._e()]}},{key:"refund_type",fn:function(e){var r=e.row;return[0==r.refund_type?a("Tag",{attrs:{color:"blue",size:"medium"}},[t._v("待处理")]):t._e(),1==r.refund_type?a("Tag",{attrs:{color:"blue",size:"medium"}},[t._v("仅退款")]):t._e(),2==r.refund_type?a("Tag",{attrs:{color:"blue",size:"medium"}},[t._v("退货退款")]):t._e(),3==r.refund_type?a("Tag",{attrs:{color:"red",size:"medium"}},[t._v("拒绝退款")]):t._e(),4==r.refund_type?a("Tag",{attrs:{color:"blue",size:"medium"}},[t._v("商品待退货")]):t._e(),5==r.refund_type?a("Tag",{attrs:{color:"blue",size:"medium"}},[t._v("退货待收货")]):t._e(),6==r.refund_type?a("Tag",{attrs:{color:"green",size:"medium"}},[t._v("已退款")]):t._e()]}},{key:"info",fn:function(e){var r=e.row;return[a("Tooltip",{attrs:{theme:"dark","max-width":"300",delay:600}},[t._l(r._info,(function(e,r){return a("div",{key:r,staticClass:"tabBox"},[a("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.cart_info.productInfo.attrInfo?e.cart_info.productInfo.attrInfo.image:e.cart_info.productInfo.image,expression:"\n                val.cart_info.productInfo.attrInfo\n                  ? val.cart_info.productInfo.attrInfo.image\n                  : val.cart_info.productInfo.image\n              "}]})]),a("span",{staticClass:"tabBox_tit line1"},[e.cart_info.is_gift?a("span",{staticClass:"font-color-red"},[t._v("赠品")]):t._e(),t._v("\n            "+t._s(e.cart_info.productInfo.store_name+" | ")+"\n            "+t._s(e.cart_info.productInfo.attrInfo?e.cart_info.productInfo.attrInfo.suk:"")+"\n          ")])])})),a("div",{attrs:{slot:"content"},slot:"content"},t._l(r._info,(function(e,r){return a("div",{key:r},[e.cart_info.is_gift?a("p",{staticClass:"font-color-red"},[t._v("赠品")]):t._e(),a("p",[t._v(t._s(e.cart_info.productInfo.store_name))]),a("p",[t._v(" "+t._s(e.cart_info.productInfo.attrInfo?e.cart_info.productInfo.attrInfo.suk:""))]),a("p",{staticClass:"tabBox_pice"},[t._v(t._s("￥"+e.cart_info.truePrice+" x "+e.cart_info.cart_num))])])})),0)],2)]}},{key:"statusName",fn:function(e){var r=e.row;return[a("Tooltip",{attrs:{theme:"dark","max-width":"300",delay:600}},[a("div",{staticClass:"pt5",domProps:{innerHTML:t._s(r.refund_reason)}}),a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"pt5"},[t._v("退款原因："+t._s(r.refund_explain))]),r.refund_goods_explain?a("div",{staticClass:"pt5"},[t._v("退货原因："+t._s(r.refund_goods_explain))]):t._e()])]),r.refund_img?a("div",{staticClass:"pictrue-box"},t._l(r.refund_img||[],(function(t,e){return a("div",{directives:[{name:"viewer",rawName:"v-viewer"}],key:e},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t,expression:"item"}],staticClass:"pictrue mr10",attrs:{src:t}})])})),0):t._e()]}},{key:"statusGoodName",fn:function(e){var r=e.row;e.index;return[a("div",{staticClass:"pt5",domProps:{innerHTML:t._s(r.refund_goods_explain)}}),a("div",{staticClass:"pictrue-box"},t._l(r.refund_goods_img||[],(function(e,i){return r.refund_goods_img?a("div",{directives:[{name:"viewer",rawName:"v-viewer"}],key:i},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"item"}],staticClass:"pictrue mr10",attrs:{src:e}})]):t._e()})),0)]}},{key:"action",fn:function(e){var r=e.row;return[a("a",{directives:[{name:"show",rawName:"v-show",value:(1==r.apply_type||5==r.refund_type||4==r.refund_type&&3==r.apply_type)&&![3,6].includes(r.refund_type)&&(parseFloat(r.pay_price)>parseFloat(r.refunded_price)||0==r.pay_price),expression:"\n            (row.apply_type == 1 || row.refund_type == 5 || (row.refund_type == 4 && row.apply_type == 3)) &&\n            ![3, 6].includes(row.refund_type) &&\n            (parseFloat(row.pay_price) > parseFloat(row.refunded_price) || row.pay_price == 0)\n          "}],attrs:{disabled:t.openErp},on:{click:function(e){return t.changeMenu(r,"5")}}},[t._v("立即退款")]),a("Divider",{directives:[{name:"show",rawName:"v-show",value:(1==r.apply_type||5==r.refund_type||4==r.refund_type&&3==r.apply_type)&&![3,6].includes(r.refund_type)&&(parseFloat(r.pay_price)>parseFloat(r.refunded_price)||0==r.pay_price),expression:"\n            (row.apply_type == 1 || row.refund_type == 5 || (row.refund_type == 4 && row.apply_type == 3)) &&\n            ![3, 6].includes(row.refund_type) &&\n            (parseFloat(row.pay_price) > parseFloat(row.refunded_price) || row.pay_price == 0)\n          "}],attrs:{type:"vertical"}}),a("a",{directives:[{name:"show",rawName:"v-show",value:[2,3].includes(r.apply_type)&&[0,1,2].includes(r.refund_type),expression:"\n            [2, 3].includes(row.apply_type) && [0, 1, 2].includes(row.refund_type)"}],attrs:{disabled:t.openErp},on:{click:function(e){return t.changeMenu(r,"55")}}},[t._v("同意退货")]),a("Divider",{directives:[{name:"show",rawName:"v-show",value:[2,3].includes(r.apply_type)&&[0,1,2].includes(r.refund_type),expression:"[2, 3].includes(row.apply_type) && [0, 1, 2].includes(row.refund_type)"}],attrs:{type:"vertical"}}),a("a",{on:{click:function(e){return t.changeMenu(r,"2")}}},[t._v("订单详情")])]}}])}),a("div",{staticClass:"acea-row row-right page"},[a("Page",{attrs:{total:t.total,current:t.pagination.page,"show-elevator":"","show-total":"","page-size":t.pagination.limit},on:{"on-change":t.pageChange}})],1)],1),a("edit-from",{ref:"edits",attrs:{FromData:t.FromData},on:{submitFail:t.submitFail}}),a("details-from",{ref:"detailss",attrs:{orderDatalist:t.orderDatalist,orderId:t.orderId,rowActive:t.rowActive}}),a("order-remark",{ref:"remarks",attrs:{remarkType:"refund",orderId:t.orderId},on:{submitFail:t.submitFail}}),a("order-record",{ref:"record"})],1)},i=[],n=a("a34a"),o=a.n(n),s=a("f8b7"),d=a("31b4"),c=a("91b4"),l=a("7dc5"),u=a("5465"),p=a("0b65");function f(t,e,a,r,i,n,o){try{var s=t[n](o),d=s.value}catch(c){return void a(c)}s.done?e(d):Promise.resolve(d).then(r,i)}function m(t){return function(){var e=this,a=arguments;return new Promise((function(r,i){var n=t.apply(e,a);function o(t){f(n,r,i,o,s,"next",t)}function s(t){f(n,r,i,o,s,"throw",t)}o(void 0)}))}}var _={components:{editFrom:d["a"],detailsFrom:c["a"],orderRemark:l["a"],orderRecord:u["a"]},data:function(){return{thead:[{title:"订单号",align:"center",slot:"order_id",minWidth:150},{title:"用户信息",slot:"nickname",minWidth:130},{title:"商品信息",slot:"info",minWidth:300},{title:"实际支付",key:"pay_price",minWidth:70},{title:"发起退款时间",key:"add_time",minWidth:110},{title:"售后类型",slot:"apply_type",minWidth:180},{title:"退款状态",slot:"refund_type",minWidth:100},{title:"退款信息",slot:"statusName",minWidth:100},{title:"退货信息",slot:"statusGoodName",minWidth:100},{title:"售后备注",key:"remark",minWidth:80},{title:"操作",slot:"action",fixed:"right",minWidth:150,align:"center"}],tbody:[],num:[],orderDatalist:null,loading:!1,FromData:null,total:0,orderId:0,animal:1,pagination:{page:1,limit:15,order_id:"",time:"",refund_type:"",apply_type:"",refund_reason:""},options:p["a"],timeVal:[],modal:!1,qrcode:null,name:"",spin:!1,rowActive:{},reasonList:[]}},computed:{labelWidth:function(){return this.isMobile?void 0:80},labelPosition:function(){return this.isMobile?"top":"right"}},created:function(){this.getOrderList(),this.getReasonOption()},methods:{reset:function(){this.pagination={page:1,limit:15,order_id:"",time:"",refund_type:"",apply_type:"",refund_reason:""},this.timeVal=[],this.getOrderList()},onchangeTime:function(t){this.pagination.page=1,this.timeVal=t,this.pagination.time=this.timeVal[0]?this.timeVal.join("-"):""},getData:function(t,e){var a=this;Object(s["k"])(t).then(function(){var t=m(o.a.mark((function t(r){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e||(a.$refs.detailss.modals=!0),a.$refs.detailss.activeName="detail",a.orderDatalist=r.data;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){a.$Message.error(t.msg)}))},getReasonOption:function(){var t=this;Object(s["D"])().then((function(e){t.reasonList=e.data}))},changeMenu:function(t,e){var a=this;switch(this.orderId=t.id,e){case"1":this.delfromData={title:"修改立即支付",url:"/order/pay_offline/".concat(t.id),method:"post",ids:""},this.$modalSure(this.delfromData).then((function(t){a.$Message.success(t.msg),a.getOrderList()})).catch((function(t){console.log(t),a.$Message.error(t.msg)}));break;case"2":this.rowActive=t,this.getData(t.id);break;case"3":this.$refs.record.modals=!0,this.$refs.record.getList(t.store_order_id);break;case"4":this.$refs.remarks.modals=!0,this.$refs.remarks.formValidate.remark=t.remark;break;case"5":this.getOnlyRefundData(t.id,t.refund_type);break;case"55":this.getRefundData(t.id,t.refund_type);break;case"6":this.getRefundIntegral(t.id);break;case"7":this.getNoRefundData(t.id);break;case"8":this.delfromData={title:"修改确认收货",url:"/order/take/".concat(t.id),method:"put",ids:""},this.$modalSure(this.delfromData).then((function(t){a.$Message.success(t.msg),a.getOrderList()})).catch((function(t){a.$Message.error(t.msg)}));break;case"10":this.delfromData={title:"立即打印订单",info:"您确认打印此订单吗?",url:"/order/print/".concat(t.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(t){a.$Message.success(t.msg),a.$emit("changeGetTabs"),a.getOrderList()})).catch((function(t){console.log(t),a.$Message.error(t.msg)}));break;case"11":this.delfromData={title:"立即打印电子面单",info:"您确认打印此电子面单吗?",url:"/order/order_dump/".concat(t.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(t){a.$Message.success(t.msg),a.getOrderList()})).catch((function(t){a.$Message.error(t.msg)}));break;default:this.delfromData={title:"删除订单",url:"/order/del/".concat(t.id),method:"DELETE",ids:""},this.delOrder(t,this.delfromData)}},getOnlyRefundData:function(t,e){var a=this;this.$modalForm(Object(s["m"])(t)).then((function(){a.getOrderList(),a.getData(a.orderId,1),a.$emit("changeGetTabs")}))},getRefundData:function(t,e){var a=this;this.delfromData={title:"是否立即退货",url:"/refund/agree/".concat(t),method:"get"},this.$modalSure(this.delfromData).then((function(t){a.$Message.success(t.msg),a.getOrderList(),a.getData(a.orderId,1)})).catch((function(t){a.$Message.error(t.msg)}))},getRefundIntegral:function(t){var e=this;Object(s["C"])(t).then(function(){var t=m(o.a.mark((function t(a){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.FromData=a.data,e.$refs.edits.modals=!0;case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))},delOrder:function(t,e){var a=this;if(1===t.is_del)this.$modalSure(e).then((function(t){a.$Message.success(t.msg),a.getOrderList()})).catch((function(t){a.$Message.error(t.msg)}));else{var r="错误！",i="<p>您选择的的订单存在用户未删除的订单，无法删除用户未删除的订单！</p>";this.$Modal.error({title:r,content:i})}},submitFail:function(){this.getOrderList(),this.getData(this.orderId,1)},selectChange2:function(t){this.pagination.page=1,this.pagination.refund_type=t,this.getOrderList(t)},getNoRefundData:function(t){var e=this;this.$modalForm(Object(s["n"])(t)).then((function(){e.getOrderList(),e.getData(e.orderId),e.$emit("changeGetTabs")}))},getOrderList:function(){var t=this;this.loading=!0,Object(s["s"])(this.pagination).then((function(e){t.loading=!1;var a=e.data,r=a.count,i=a.list,n=a.num;t.total=r,t.tbody=i,t.num=n,i.forEach((function(e){e.id==t.orderId&&(t.rowActive=e)}))})).catch((function(e){t.loading=!1,t.$Message.error(e.msg)}))},pageChange:function(t){this.pagination.page=t,this.getOrderList()},nameSearch:function(){this.pagination.page=1,this.getOrderList()},orderSearch:function(){this.pagination.page=1,this.getOrderList()},delivery:function(t){var e=this;Object(s["e"])(t.id).then(function(){var t=m(o.a.mark((function t(a){return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.FromData=a.data,e.$refs.edits.modals=!0;case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))}}},h=_,g=(a("c76a"),a("2877")),v=Object(g["a"])(h,r,i,!1,null,"89cab458",null);e["default"]=v.exports},"5c50":function(t,e,a){},c76a:function(t,e,a){"use strict";var r=a("5c50"),i=a.n(r);i.a}}]);