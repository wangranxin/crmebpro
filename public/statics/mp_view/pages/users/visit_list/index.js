require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/visit_list/index"],{"156d":function(t,i,e){"use strict";var n=e("b846"),s=e.n(n);s.a},2233:function(t,i,e){"use strict";e.r(i);var n=e("4813"),s=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(o);i["default"]=s.a},4813:function(t,i,e){"use strict";(function(t){var n=e("47a9");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=e("0f73"),o=e("8f59"),c=e("5088"),l=n(e("89cc")),a=e("4d38"),h={components:{recommend:function(){Promise.all([e.e("common/vendor"),e.e("components/recommend/index")]).then(function(){return resolve(e("a60c"))}.bind(null,e)).catch(e.oe)},BaseMoney:function(){e.e("components/BaseMoney").then(function(){return resolve(e("7202"))}.bind(null,e)).catch(e.oe)},emptyPage:function(){e.e("components/emptyPage").then(function(){return resolve(e("398a"))}.bind(null,e)).catch(e.oe)}},mixins:[l.default],data:function(){return{isShowChecked:0,count:0,times:[],isAllSelect:!1,hostProduct:[],loadTitle:"加载更多",loading:!1,loadend:!1,visitList:[],limit:21,page:1,isAuto:!1,isShowAuth:!1,hotScroll:!1,hotPage:1,hotLimit:10,isItemAll:[],imgHost:a.HTTP_REQUEST_URL}},computed:(0,o.mapGetters)(["isLogin"]),onLoad:function(){this.get_host_product(),this.loadend=!1,this.page=1,this.visitList=[],this.isLogin?this.get_user_visit_list():(0,c.toLogin)()},onShow:function(){t.removeStorageSync("form_type_cart"),this.times=[],this.loadend=!1,this.page=1,this.visitList=[],this.get_user_visit_list()},methods:{goDetails:function(i){if(this.isShowChecked||!i.is_show)return!1;t.navigateTo({url:"/pages/goods_details/index?id="+i.product_id})},switchTap:function(){this.isShowChecked=!this.isShowChecked},collect:function(){var t=this,i=[];if(this.visitList.forEach((function(t){t.picList.forEach((function(t){t.checked&&i.push(t.product_id)}))})),!i.length)return this.$util.Tips({title:"请选择收藏商品"});(0,s.collectAdd)(i).then((function(i){return t.$util.Tips({title:i.msg})}))},del:function(){var t=this,i=[];if(this.visitList.forEach((function(t){t.picList.forEach((function(t){t.checked&&i.push(t.product_id)}))})),!i.length)return this.$util.Tips({title:"请选择删除商品"});(0,s.deleteVisitList)({ids:i}).then((function(i){return t.times=[],t.loadend=!1,t.page=1,t.$set(t,"visitList",[]),t.get_user_visit_list(),t.$util.Tips({title:i.msg})})).catch((function(i){return t.$util.Tips({title:i})}))},picCheckbox:function(t,i){var e=t.detail.value;this.visitList[i].picList.forEach((function(t){-1!==e.indexOf(t.id+"")?t.checked=!0:t.checked=!1})),this.visitList[i].picList.length==e.length?this.visitList[i].checked=!0:this.visitList[i].checked=!1;var n=[];this.visitList.forEach((function(t){t.checked?n.push(t.time):-1!==n.indexOf(t.time)&&n.remove(t.time)})),n.length==this.visitList.length?this.isAllSelect=!0:this.isAllSelect=!1},checkboxChange:function(t){var i=t.detail.value;this.isItemAll=i,this.visitList.forEach((function(t,e){-1!==i.indexOf(t.time)?t.checked=!0:t.checked=!1,t.picList.forEach((function(i){t.checked?i.checked=!0:i.checked=!1}))})),i.length===this.visitList.length?this.isAllSelect=!0:this.isAllSelect=!1},forGoods:function(t){this.visitList.length&&this.visitList.forEach((function(i){i.checked=!!t,i.picList.forEach((function(i){i.checked=!!t}))}))},checkboxAllChange:function(t){var i=t.detail.value;i.length?(this.isAllSelect=!0,this.forGoods(1)):(this.isAllSelect=!1,this.forGoods(0))},authColse:function(t){this.isShowAuth=t},onLoadFun:function(){this.get_user_visit_list(),this.isShowAuth=!1},get_user_visit_list:function(){var t=this,i=this;this.loading||this.loadend||(i.loading=!0,i.loadTitle="",(0,s.getVisitList)({page:i.page,limit:i.limit}).then((function(e){t.count=e.data.count;for(var n=0;n<e.data.time.length;n++)-1==t.times.indexOf(e.data.time[n])&&(t.times.push(e.data.time[n]),t.visitList.push({time:e.data.time[n],picList:[]}));for(var s=0;s<t.times.length;s++){t.visitList[s].checked=!!t.isAllSelect;for(var o=0;o<e.data.list.length;o++)t.times[s]===e.data.list[o].time_key&&(t.isAllSelect?e.data.list[o].checked=!0:e.data.list[o].checked=!1,t.visitList[s].picList.push(e.data.list[o]))}var c=e.data.list.length<i.limit;i.loadend=c,i.loadTitle=c?"没有更多内容啦~":"加载更多",i.page=i.page+1,i.loading=!1})).catch((function(t){i.loading=!1,i.loadTitle="加载更多"})))},get_host_product:function(){var t=this;t.hotScroll||(0,s.getProductHot)(t.hotPage,t.hotLimit).then((function(i){t.hotPage++,t.hotScroll=i.data.length<t.hotLimit,t.hostProduct=t.hostProduct.concat(i.data)}))}},onPageScroll:function(i){t.$emit("scroll")},onReachBottom:function(){this.visitList.length?this.get_user_visit_list():this.get_host_product()}};i.default=h}).call(this,e("df3c")["default"])},"8cea":function(t,i,e){"use strict";e.d(i,"b",(function(){return s})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return n}));var n={easyLoadimage:function(){return e.e("components/easy-loadimage/easy-loadimage").then(e.bind(null,"94dd"))}},s=function(){var t=this,i=t.$createElement,e=(t._self._c,t.visitList.length),n=e?t.__map(t.visitList,(function(i,e){var n=t.__get_orig(i),s=t.__map(i.picList,(function(i,e){var n=t.__get_orig(i),s=t.isShowChecked?i.id.toString():null;return{$orig:n,g1:s}}));return{$orig:n,l0:s}})):null,s=e?null:t.visitList.length;t.$mp.data=Object.assign({},{$root:{g0:e,l1:n,g2:s}})},o=[]},b846:function(t,i,e){},bf3b:function(t,i,e){"use strict";e.r(i);var n=e("8cea"),s=e("2233");for(var o in s)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return s[t]}))}(o);e("156d");var c=e("828b"),l=Object(c["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);i["default"]=l.exports},ce58:function(t,i,e){"use strict";(function(t,i){var n=e("47a9");e("f076");n(e("3240"));var s=n(e("bf3b"));t.__webpack_require_UNI_MP_PLUGIN__=e,i(s.default)}).call(this,e("3223")["default"],e("df3c")["createPage"])}},[["ce58","common/runtime","common/vendor"]]]);