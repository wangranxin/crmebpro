require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/user_invoice_form/index"],{"2cdc":function(e,t,n){"use strict";n.r(t);var o=n("d63d"),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},"3f05":function(e,t,n){},"54b9":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var o=function(){var e=this.$createElement;this._self._c},i=[]},"5b02":function(e,t,n){"use strict";n.r(t);var o=n("54b9"),i=n("2cdc");for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("65ef");var r=n("828b"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"5f5f3750",null,!1,o["a"],void 0);t["default"]=c.exports},"65ef":function(e,t,n){"use strict";var o=n("3f05"),i=n.n(o);i.a},"90e8":function(e,t,n){"use strict";(function(e,t){var o=n("47a9");n("f076");o(n("3240"));var i=o(n("5b02"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},d63d:function(e,t,n){"use strict";(function(e,o){var i=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n("92f9"),r=i(n("89cc")),c={mixins:[r.default],data:function(){return{invoiceTypeList:[{name:"普通发票",value:1,info:"纸质发票开出后将以邮寄形式交付"},{name:"专用发票",value:2,info:"纸质发票开出后将以邮寄形式交付"}],headerTypeList:[{name:"个人",value:1},{name:"企业",value:2}],formData:{id:"",header_type:1,type:1,drawer_phone:"",name:"",duty_number:"",tell:"",address:"",bank:"",card_number:"",is_default:0,email:""},popupType:!1,typeName:"",urlQuery:"",from:"",specialInvoice:!0,order_id:""}},computed:{backUrl:function(){switch(this.from){case"order_confirm":return"/pages/goods/order_confirm/index".concat(this.urlQuery);default:return"/pages/users/user_invoice_list/index?from=invoice_form"}}},onPageScroll:function(t){e.$emit("scroll")},onLoad:function(e){var t=this;for(var n in e)switch(n){case"couponTitle":case"new":case"cartId":case"pinkId":case"couponId":case"addressId":this.urlQuery+="".concat(this.urlQuery?"&":"?").concat(n,"=").concat(e[n]);break;case"from":this.from=e[n];break;case"header_type":this.header_type=e[n];break;case"id":this.id=e[n],this.getInvoiceDetail();break;case"specialInvoice":"false"===e[n]&&(this.specialInvoice=!1);break}e.order_id&&(this.order_id=e.order_id);var o=this.invoiceTypeList.find((function(e){return e.value===t.formData.type}));this.typeName=o.name},onShow:function(){e.removeStorageSync("form_type_cart")},methods:{exportInvoice:function(){var e=this;o.chooseInvoiceTitle({success:function(t){e.formData.header_type=0==t.type?2:1,e.formData.name=t.title,e.formData.duty_number=t.taxNumber,e.formData.address=t.companyAddress,e.formData.drawer_phone=t.telephone,e.formData.bank=t.bankName,e.formData.card_number=t.bankAccount},fail:function(e){}})},getInvoiceDetail:function(){var t=this;e.showLoading({title:"加载中"}),(0,a.invoiceDetail)(this.id).then((function(n){e.hideLoading(),t.formData=n.data})).catch((function(t){e.showToast({title:t,icon:"none"})}))},formSubmit:function(t){var n=this,o=this.formData;if(1==o.header_type){if(!o.name)return e.showToast({title:"请输入需要开具发票的姓名",icon:"none"});if(!o.drawer_phone)return e.showToast({title:"请输入您的手机号",icon:"none"});if(!o.email)return e.showToast({title:"请输入您的联系邮箱",icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(o.email))return e.showToast({title:"请正确输入您的联系邮箱",icon:"none"})}if(2==o.header_type){if(1==o.type){if(!o.name)return e.showToast({title:"请输入需要开具发票的企业名称",icon:"none"});if(!o.duty_number)return e.showToast({title:"请输入纳税人识别号",icon:"none"});if(!/[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}/.test(o.duty_number))return e.showToast({title:"请正确输入单位税号",icon:"none"});if(!o.drawer_phone)return e.showToast({title:"请输入您的手机号",icon:"none"});if(!o.email)return e.showToast({title:"请输入您的联系邮箱",icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(o.email))return e.showToast({title:"请正确输入您的联系邮箱",icon:"none"})}if(2==o.type){if(!o.name)return e.showToast({title:"请输入需要开具发票的企业名称",icon:"none"});if(!o.duty_number)return e.showToast({title:"请输入纳税人识别号",icon:"none"});if(!/[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}/.test(o.duty_number))return e.showToast({title:"请正确输入纳税人识别号",icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(o.drawer_phone))return e.showToast({title:"请正确输入您的手机号",icon:"none"});if(!o.email)return e.showToast({title:"请输入您的联系邮箱",icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(o.email))return e.showToast({title:"请正确输入您的联系邮箱",icon:"none"});if(!o.bank)return e.showToast({title:"请输入您的开户银行",icon:"none"});if(!o.card_number)return e.showToast({title:"请输入您的银行账号",icon:"none"});if(!o.address)return e.showToast({title:"请输入您所在的企业地址",icon:"none"});if(!o.tell)return e.showToast({title:"请输入您的企业电话",icon:"none"})}}o.id=this.id,e.showLoading({title:"保存中"}),(0,a.invoiceSave)(o).then((function(t){var i=n;e.showToast({title:"保存成功",icon:"success",success:function(){switch(i.from){case"order_confirm":var n="";n+=1==o.header_type?"个人":"企业",n+=1==o.type?"普通":"专用",n+="发票",i.id?e.navigateTo({url:"/pages/goods/order_confirm/index".concat(i.urlQuery,"&invoice_id=").concat(i.id,"&invoice_name=").concat(n)}):e.navigateTo({url:"/pages/goods/order_confirm/index".concat(i.urlQuery,"&invoice_id=").concat(t.data.id,"&invoice_name=").concat(n)});break;case"order_details":i.id?e.navigateTo({url:"/pages/goods/order_details/index?order_id=".concat(i.order_id,"&invoice_id=").concat(i.id)}):e.navigateTo({url:"/pages/goods/order_details/index?order_id=".concat(i.order_id,"&invoice_id=").concat(t.data.id)});break;default:e.navigateTo({url:"/pages/users/user_invoice_list/index?from=invoice_form"});break}}})})).catch((function(t){e.showToast({title:t,icon:"none"})}))},callType:function(){this.popupType=!0},changeType:function(e){2==e.value&&1==this.formData.header_type&&(this.formData.header_type=2),this.typeName=e.name,this.formData.type=e.value},closeType:function(){this.popupType=!1},changeHeaderType:function(e){this.formData.header_type=e,this.formData.type=1},changeDefault:function(){this.formData.is_default=1-this.formData.is_default}}};t.default=c}).call(this,n("df3c")["default"],n("3223")["default"])}},[["90e8","common/runtime","common/vendor"]]]);