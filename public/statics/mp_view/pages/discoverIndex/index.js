(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/discoverIndex/index"],{"37da":function(t,e,i){"use strict";i.r(e);var n=i("9c41"),o=i("b1bd");for(var s in o)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(s);i("49a9");var a=i("828b"),c=Object(a["a"])(o["default"],n["b"],n["c"],!1,null,"1b73711e",null,!1,n["a"],void 0);e["default"]=c.exports},"403a":function(t,e,i){"use strict";(function(t,e){var n=i("47a9");i("f076");n(i("3240"));var o=n(i("37da"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},"49a9":function(t,e,i){"use strict";var n=i("be94"),o=i.n(n);o.a},"9c41":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var n={easyLoadimage:function(){return i.e("components/easy-loadimage/easy-loadimage").then(i.bind(null,"94dd"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__get_style([t.menuBoxStyle])),n=0==t.tabActive?t.followList.length:null,o=0==t.tabActive&&n?t.followList.length&&t.followList.length>9:null,s=0==t.tabActive?t.contentList.length:null,a=0==t.tabActive&&s?t.__map(t.contentList,(function(e,i){var n=t.__get_orig(e),o=e.product&&e.product.length>1,s=o?null:e.product&&1==e.product.length;return{$orig:n,g3:o,g4:s}})):null,c=0==t.tabActive?t.recommendList.length:null,r=0==t.tabActive&&c?t.__map(t.recommendList,(function(e,i){var n=t.__get_orig(e),o=e.community.length;return{$orig:n,g6:o}})):null,u=1==t.tabActive?t.contentList.length:null,l=t.showBubble?t.__get_style([t.bubbleShadow]):null,h=t.showBubble?t.__get_style([t.lineColor]):null;t._isMounted||(t.e0=function(){t.showCateDrawer=!1}),t.$mp.data=Object.assign({},{$root:{s0:i,g0:n,g1:o,g2:s,l0:a,g5:c,l1:r,g7:u,s1:l,s2:h}})},s=[]},b1bd:function(t,e,i){"use strict";i.r(e);var n=i("f76b"),o=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a},be94:function(t,e,i){},f76b:function(t,e,i){"use strict";(function(t,n){var o=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=o(i("7ca3")),a=(i("4d38"),o(i("89cc"))),c=i("8f59"),r=i("5088"),u=(i("769c"),i("eb8a"));function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){(0,s.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var f=t.getWindowInfo().statusBarHeight,d={data:function(){return{sysHeight:f,tabActive:1,params:{page:1,limit:10,topic_id:"",keyword:"",is_follow:0,content_type:""},topicList:[],topicNoRecmmend:[],contentList:[],recommendList:[],recommendParams:{page:1,limit:20},cateActive:"",loading:!1,recLoading:!1,showCateDrawer:!1,showBubble:!1,showFooter:!1,bubbleBg:"#ffffff",bubbleText:"#333333",infoData:{},followList:[],recommendTopic:[],intoindex:"",marTop:"40px",configData:{community_status:1,community_comment_add:1,community_comment_status:1}}},mixins:[a.default],components:{emptyPage:function(){i.e("components/emptyPage").then(function(){return resolve(i("398a"))}.bind(null,i)).catch(i.oe)},waterfallsFlow:function(){i.e("components/discoverWaterfall/WaterfallsFlow").then(function(){return resolve(i("831d"))}.bind(null,i)).catch(i.oe)},baseDrawer:function(){i.e("components/tui-drawer/tui-drawer").then(function(){return resolve(i("af01"))}.bind(null,i)).catch(i.oe)},discoverVideo:function(){i.e("components/discoverVideo/index").then(function(){return resolve(i("5e30"))}.bind(null,i)).catch(i.oe)},pageFooter:function(){Promise.all([i.e("common/vendor"),i.e("components/pageFooter/index")]).then(function(){return resolve(i("b795"))}.bind(null,i)).catch(i.oe)},BaseTextMore:function(){i.e("components/BaseTextMore").then(function(){return resolve(i("c682"))}.bind(null,i)).catch(i.oe)}},provide:function(){return{flowLike:this.flowLike}},onPageScroll:function(e){this.showBubble=!1,t.$emit("scroll")},onReachBottom:function(){this.getList()},onPullDownRefresh:function(){0==this.tabActive?(this.params.is_follow=1,this.getFollow(),this.getRecommendList()):this.params.is_follow=0,this.params.page=1,this.params.topic_id="",this.contentList=[],this.loading=!1,this.getConfig(),this.getList(),setTimeout((function(){t.stopPullDownRefresh()}),1e3)},computed:h(h({},(0,c.mapGetters)(["isLogin","uid"])),{},{pageTheme:function(){return 2==this.tabActive?"dark":"light"},bubbleShadow:function(){if([0,1].includes(this.tabActive))return{"box-shadow":"0rpx 2rpx 15rpx 0rpx rgba(0,0,0,0.102)"}},menuBoxStyle:function(){var t=n.getMenuButtonBoundingClientRect();return{width:t.left+"px"}},lineColor:function(){return 2==this.tabActive?{"border-bottom":"1rpx solid rgba(238, 238, 238, 0.1)"}:{"border-bottom":"1rpx solid #eeeeee"}}}),onLoad:function(){this.getHeight(),this.getConfig(),this.getTopic(),this.getList()},methods:{getConfig:function(){var t=this;(0,u.getCommunityConfig)().then((function(e){t.configData=e.data}))},getHeight:function(){var e=this,i=t.createSelectorQuery().in(this);i.select(".header_box").boundingClientRect((function(t){t&&(e.marTop=t.height+"px")})).exec()},changeTab:function(e){this.tabActive!=e&&(t.pageScrollTo({duration:0,scrollTop:0}),0==e?(this.params.is_follow=1,this.params.content_type="",this.bubbleBg="#ffffff",this.bubbleText="#333333",this.getFollow(),this.getRecommendList()):1==e?(this.params.is_follow=0,this.params.content_type="",this.bubbleBg="#ffffff",this.bubbleText="#333333"):(this.params.is_follow=0,this.bubbleBg="rgba(51, 51, 51, 0.7)",this.bubbleText="#ffffff",this.infoData=null),this.showBubble=!1,this.showCateDrawer=!1,this.tabActive=e,this.params.page=1,this.params.topic_id="",this.contentList=[],this.loading=!1,this.getList())},changeCate:function(t,e){var i=this;this.cateActive=e,this.$nextTick((function(){i.intoindex="sort"+t})),this.params.page=1,this.params.topic_id=e,this.contentList=[],this.loading=!1,this.showCateDrawer=!1,this.getList()},getFollow:function(){var t=this;(0,u.communityFlowIndexApi)().then((function(e){t.followList=e.data})).catch((function(e){return t.$util.Tips({title:e})}))},beforeRequest:function(t){this.showBubble&&(this.showBubble=!1),this.contentList.length-1==t&&this.getList()},resShare:function(t){this.infoData=t},authTo:function(t){this.$util.JumpPath(t)},bubbleTo:function(t){this.showBubble=!1,this.isLogin?this.$util.JumpPath(t):(0,r.toLogin)()},toggleBubble:function(){this.showBubble=!this.showBubble},newDataStatus:function(t){this.showFooter=!!t},getTopic:function(){var t=this;(0,u.getTopicApi)({page:1,limit:10}).then((function(e){t.topicList=e.data,t.topicNoRecmmend=t.topicList})),(0,u.getTopicApi)({page:1,limit:10,is_recommend:1}).then((function(e){t.recommendTopic=e.data}))},getList:function(){var t=this;this.loading||(this.loading=!0,(0,u.communityListApi)(this.params).then((function(e){var i=e.data,n=i.length<t.params.limit;t.contentList=t.contentList.concat(i),t.params.page++,t.loading=n})))},toggleCateDrawer:function(){this.showCateDrawer=!this.showCateDrawer},likeFun:function(t){this.contentList[t.index].is_like=t.status,1==t.status?this.contentList[t.index].like_num++:this.contentList[t.index].like_num--},flowLike:function(t){var e=this.contentList.findIndex((function(e){return t.id==e.id}));this.contentList[e].is_like=t.status,1==t.status?this.contentList[e].like_num++:this.contentList[e].like_num--},contentLike:function(t){var e=this,i=t.id,n=1==t.is_like?0:1;(0,u.communityLikeApi)(i,{status:n}).then((function(e){t.is_like=n,1==n?t.like_num++:t.like_num--})).catch((function(t){return e.$util.Tips({title:t})}))},followUser:function(t){return this.contentList[t.index].is_follow=1,this.$util.Tips({title:"关注成功"})},followRecommendUser:function(t,e){var i=this;if(!this.isLogin)return this.$util.Tips({title:"请登录"});(0,u.communitySetInsterestApi)(t.relation_id,{status:1}).then((function(e){return t.is_follow=1,i.$util.Tips({title:e.msg})})).catch((function(t){return i.$util.Tips({title:t})}))},getRecommendList:function(){var t=this;this.recLoading||(this.recLoading=!0,(0,u.communityRecommendListApi)(this.recommendParams).then((function(e){t.recommendList=e.data,t.recLoading=!1})))},toRight:function(){setTimeout((function(){t.navigateTo({url:"/pages/discover/discoverFollow/index?type=1"})}),500)},openShare:function(t){this.infoData=t,(0,u.communityShareApi)(t.id).catch((function(t){}))}},onShareAppMessage:function(){return{title:this.infoData.title||this.infoData.content,imageUrl:this.infoData.image,path:"/pages/discover/".concat(1==this.infoData.content_type?"discoverDetails":"discoverVideo","/index?id=").concat(this.infoData.id,"&spid=").concat(this.uid)}}};e.default=d}).call(this,i("df3c")["default"],i("3223")["default"])}},[["403a","common/runtime","common/vendor"]]]);