(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/activity/coupon/index"],{"1f15":function(t,e,n){"use strict";var r=n("9881"),i=n.n(r);i.a},"3c11":function(t,e,n){"use strict";(function(t,e){var r=n("47a9");n("f076");r(n("3240"));var i=r(n("3cd2"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(i.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"3cd2":function(t,e,n){"use strict";n.r(e);var r=n("d7b9"),i=n("e477");for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("1f15");var o=n("828b"),s=Object(o["a"])(i["default"],r["b"],r["c"],!1,null,"3b7f200b",null,!1,r["a"],void 0);e["default"]=s.exports},"75e3":function(t,e,n){"use strict";(function(t){var r=n("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n("7ca3")),a=n("360a"),o=n("5088"),s=n("8f59"),c=r(n("89cc")),u=n("4d38");function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d=t.getWindowInfo().statusBarHeight,f={mixins:[c.default],components:{emptyPage:function(){n.e("components/emptyPage").then(function(){return resolve(n("398a"))}.bind(null,n)).catch(n.oe)},NavBar:function(){n.e("components/NavBar").then(function(){return resolve(n("a7d8"))}.bind(null,n)).catch(n.oe)}},data:function(){return{sysHeight:d,couponsList:[],loading:!1,loadend:!1,loadTitle:"加载更多",params:{page:1,limit:20,type:"",defaultOrder:1,timeOrder:"",priceOrder:""},isAuto:!1,isShowAuth:!1,navList:[{name:"全部",type:""},{name:"快过期",type:-1},{name:"通用券",type:0},{name:"品类券",type:1},{name:"商品券",type:2},{name:"品牌券",type:3}],count:0,imgHost:u.HTTP_REQUEST_URL,pageScrollStatus:!1,showDrop:!1,current:0,price:0}},watch:{isLogin:{handler:function(t,e){t&&this.getUseCoupons()},deep:!0}},computed:l(l({},(0,s.mapGetters)(["isLogin"])),{},{headerBg:function(){return"url("+this.imgHost+"/statics/images/get_coupon_bg.png)no-repeat center center/100% 100%, linear-gradient(90deg, var(--view-gradient) 0%, var(--view-theme) 100%)"}}),filters:{typeFilter:function(t){return{0:"通用券",1:"品类券",2:"商品券",3:"品牌券"}[t]}},onPageScroll:function(e){e.scrollTop>130?this.pageScrollStatus=!0:e.scrollTop<130&&(this.pageScrollStatus=!1),t.$emit("scroll")},onLoad:function(){this.isLogin?this.getUseCoupons():(0,o.toLogin)()},onReachBottom:function(){this.getUseCoupons()},methods:{changeTab:function(t){this.current=t,0==t?(this.params.defaultOrder=1,this.params.timeOrder="",this.params.priceOrder=""):1==t?(""==this.params.timeOrder?this.params.timeOrder="asc":"asc"==this.params.timeOrder?this.params.timeOrder="desc":"desc"==this.params.timeOrder&&(this.params.timeOrder=""),this.params.defaultOrder="",this.params.priceOrder=""):2==t&&(""==this.params.priceOrder?this.params.priceOrder="asc":"asc"==this.params.priceOrder?this.params.priceOrder="desc":"desc"==this.params.priceOrder&&(this.params.priceOrder=""),this.params.defaultOrder="",this.params.timeOrder=""),this.couponsList=[],this.loadend=!1,this.loading=!1,this.params.page=1,this.getUseCoupons()},toggleRule:function(t){t.ruleShow=!t.ruleShow},backPage:function(){t.navigateBack()},goDetails:function(e){t.navigateTo({url:"/pages/goods_details/index?id="+e.id})},getCoupon:function(t,e){var n=this,r=n.couponsList;(0,a.setCouponReceive)(t).then((function(t){r[e].is_use=!0,n.$set(n,"couponsList",r),n.$util.Tips({title:"领取成功"})})).catch((function(t){return n.$util.Tips({title:t})}))},getUseCoupons:function(){var t=this,e=this;return!this.loadend&&(!this.loading&&(e.loading=!0,e.loadTitle="加载更多",void(0,a.getCoupons)(this.params).then((function(n){var r=n.data.list,i=r.length<e.params.limit;r.map((function(e){t.$set(e,"ruleShow",!1)}));var a=e.$util.SplitArray(r,e.couponsList);e.$set(e,"couponsList",a),e.loadend=i,e.loading=!1,e.loadTitle=i?"没有更多内容啦~":"加载更多",e.params.page++})).catch((function(t){e.loading=!1,e.loadTitle="加载更多"}))))},setType:function(t){this.params.type!==t?this.params.type=t:this.params.type="",this.params.page=1,this.couponsList=[],this.loadend=!1,this.showDrop=!1,this.getUseCoupons()}}};e.default=f}).call(this,n("df3c")["default"])},9881:function(t,e,n){},d7b9:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return r}));var r={easyLoadimage:function(){return n.e("components/easy-loadimage/easy-loadimage").then(n.bind(null,"94dd"))}},i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.couponsList.length),r=n?t.__map(t.couponsList,(function(e,n){var r=t.__get_orig(e),i=t._f("typeFilter")(e.type),a=1!=e.coupon_type?parseFloat(e.coupon_price):null;return{$orig:r,f0:i,m0:a}})):null,i=t.couponsList.length,a=t.couponsList.length;t._isMounted||(t.e0=function(e){t.showDrop=!t.showDrop},t.e1=function(e){t.showDrop=!1}),t.$mp.data=Object.assign({},{$root:{g0:n,l0:r,g1:i,g2:a}})},a=[]},e477:function(t,e,n){"use strict";n.r(e);var r=n("75e3"),i=n.n(r);for(var a in r)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e["default"]=i.a}},[["3c11","common/runtime","common/vendor"]]]);