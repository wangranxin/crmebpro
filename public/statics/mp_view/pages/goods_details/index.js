(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods_details/index"],{"2d99":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return s}));var s={jyfParser:function(){return Promise.all([i.e("common/vendor"),i.e("components/jyf-parser/jyf-parser")]).then(i.bind(null,"d294"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__get_style([t.navBarStyle])),s=t.__get_style([t.menuButtonStyle]),o=t.__get_style([t.shareButtonStyle]),r=t.storeInfo.spec_type?t.skuArr.length:null,n=t.discountInfo.discount.length||t.coupon.list.length||t.computedPrice.deduction.vip_price>0,c=t.diyProduct.isOpen.includes(0),a=t.diyProduct.isOpen.includes(2),u=t.diyProduct.isOpen.includes(1),d=t.storeInfo.store_label&&t.storeInfo.store_label.length,h=t.storeInfo.rank>0&&t.diyProduct.showRank?t._f("rankType")(t.storeInfo.rank_type):null,l=t.activity.length&&t.diyProduct.showService.includes(0),p=t.attr.productAttr.length&&t.diyProduct.showService.includes(1),f=t.storeInfo.ensure&&t.storeInfo.ensure.length&&t.diyProduct.showService.includes(2),g=t.storeInfo.specs&&t.storeInfo.specs.length&&t.diyProduct.showService.includes(3),m=t.discountsData.length&&t.diyProduct.showMatch,_=m?t.discountsData.length:null,v=t.good_list.length&&t.diyProduct.showRecommend,$=v?t.good_list.length:null,S=t.diyProduct.menuList.includes(0),I=t.diyProduct.menuList.includes(1),y=t.diyProduct.menuList.includes(2)&&t.routineContact,w=y?null:t.diyProduct.menuList.includes(2)&&!t.routineContact,P=t.diyProduct.menuList.includes(3),b=t.diyProduct.menuList.includes(4),C=b?parseFloat(t.CartCount):null;t._isMounted||(t.e0=function(){t.showServiceDrawer=!0},t.e1=function(){t.showServiceDrawer=!1},t.e2=function(){t.showPerferentDrawer=!1},t.e3=function(e){t.H5ShareBox=!1}),t.$mp.data=Object.assign({},{$root:{s0:i,s1:s,s2:o,g0:r,g1:n,g2:c,g3:a,g4:u,g5:d,f0:h,g6:l,g7:p,g8:f,g9:g,g10:m,g11:_,g12:v,g13:$,g14:S,g15:I,g16:y,g17:w,g18:P,g19:b,m0:C}})},r=[]},3883:function(t,e,i){"use strict";(function(t,s){var o=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,n=o(i("7eb4")),c=o(i("ee10")),a=o(i("7ca3")),u=i("0f73"),d=i("92f9"),h=(i("b0fe"),i("360a")),l=i("606e"),p=i("5088"),f=i("8f59"),g=(i("c4d7"),i("4d38")),m=i("2c18"),_=o(i("89cc"));function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function $(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(Object(i),!0).forEach((function(e){(0,a.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var S=t.getWindowInfo().statusBarHeight,I=getApp(),y={components:{zbCode:function(){Promise.all([i.e("common/vendor"),i.e("components/zb-code/zb-code")]).then(function(){return resolve(i("4d7f"))}.bind(null,i)).catch(i.oe)},productConSwiper:function(){i.e("components/productConSwiper/index").then(function(){return resolve(i("6508"))}.bind(null,i)).catch(i.oe)},productWindow:function(){i.e("components/productWindow/index").then(function(){return resolve(i("bae9"))}.bind(null,i)).catch(i.oe)},userEvaluation:function(){i.e("components/userEvaluation/index").then(function(){return resolve(i("9d0f"))}.bind(null,i)).catch(i.oe)},kefuIcon:function(){i.e("components/kefuIcon/index").then(function(){return resolve(i("d448"))}.bind(null,i)).catch(i.oe)},cusPreviewImg:function(){i.e("components/cusPreviewImg/index").then(function(){return resolve(i("9bf0"))}.bind(null,i)).catch(i.oe)},specs:function(){i.e("pages/goods_details/components/specs/index").then(function(){return resolve(i("6ee0"))}.bind(null,i)).catch(i.oe)},countDown:function(){i.e("components/countDown/index").then(function(){return resolve(i("1706"))}.bind(null,i)).catch(i.oe)},homeList:function(){i.e("components/homeList/index").then(function(){return resolve(i("7052"))}.bind(null,i)).catch(i.oe)},serviceModal:function(){i.e("pages/goods_details/components/serviceModal/index").then(function(){return resolve(i("c9ea"))}.bind(null,i)).catch(i.oe)},preferentialModal:function(){i.e("pages/goods_details/components/preferentialModal/index").then(function(){return resolve(i("61a3"))}.bind(null,i)).catch(i.oe)},"jyf-parser":function(){Promise.all([i.e("common/vendor"),i.e("components/jyf-parser/jyf-parser")]).then(function(){return resolve(i("d294"))}.bind(null,i)).catch(i.oe)}},directives:{trigger:{inserted:function(t,e){t.click()}}},mixins:[_.default],data:function(){return{showSkeleton:!0,isNodes:0,coupon:{type:-1,list:[],count:[]},attrTxt:"请选择",attrValue:"",animated:!1,id:0,replyCount:0,reply:[],storeInfo:{brand_name:""},productValue:[],cart_num:1,isOpen:!1,actionSheetHidden:!0,posterImageStatus:!1,PromotionCode:"",canvasStatus:!1,posterImage:"",sharePacket:{isState:!0},uid:0,circular:!1,autoplay:!1,interval:3e3,duration:500,good_list:[],replyChance:0,CartCount:0,isDown:!0,storeSelfMention:!0,posters:!1,weixinStatus:!1,ensureInfo:{show:!1,ensure:[],ensureTitle:""},specsInfo:{show:!1,specs:[]},discountInfo:{show:!1,discount:[]},attr:{cartAttr:!1,productAttr:[],productSelect:{}},limitInfo:{discount_price:0,price:0,discount:1,datatime:0},promotions_type:0,description:"",H5ShareBox:!1,activity:[],lock:!1,scrollTop:0,returnShow:!0,diff:"",is_money_level:1,is_vip:0,routineContact:0,discountsData:[],siteName:"",themeColor:"#e93323",fontColor:"#e93323",showAnimate:!0,skuArr:[],codeShow:!1,codeVal:"",cid:"1",shareQrcode:0,followCode:"",currentPage:!1,sysHeight:S,isShow:0,imgHost:g.HTTP_REQUEST_URL,fromType:0,cartNum:0,activityBg:"",posterTitle:"",showServiceDrawer:!1,showPerferentDrawer:!1,pageScrollStatus:!1,cartType:"",computedPrice:{deduction:{pay_price:0,sum_price:0,vip_price:0},coupon:{use_min_price:0,coupon_type:0,coupon_price:0}},isSwiper:!0,productSwiper:[],productVideoLink:"",swiperCurrent:0,userInfo:{},showSkuBox:!1,communityList:[],communityCount:0,scrollToView:0,attrPicIndex:0,tagStyle:{img:"width:100%;display:block;",table:"width:100%",video:"width:100%;float:left;"},brokerage:""}},filters:{rankType:function(t){return{1:"销量排行榜",2:"好评排行榜",3:"收藏排行榜"}[t]}},computed:$($({},(0,f.mapGetters)(["isLogin","diyProduct","storeBrokerageStatus"])),{},{showVip:function(){return!this.is_money_level&&this.computedPrice.deduction.vip_price&&this.storeInfo.is_vip&&this.diyProduct.showSvip},cardBg:function(){return"url(".concat(this.activityBg,")")},showVipPrice:function(){return!(1!=this.storeInfo.is_vip||"member"!=this.computedPrice.deduction.price_type||!this.computedPrice.deduction.vip_price)},navBarStyle:function(){return{background:this.pageScrollStatus?"#fff":"transparent",paddingTop:2*this.sysHeight+"rpx"}},showPromoterCard:function(){if(this.diyProduct.showPromoter){var t=this.diyProduct.showPromoterType;return!(![0,2].includes(t)||this.isLogin)||!!(0==t||1==t&&this.isLogin&&1==this.userInfo.is_promoter||2==t&&this.isLogin&&0==this.userInfo.is_promoter)}return!1},showMenuPromoterShare:function(){var t=this.diyProduct.showMenuPromoterShare;return!(![0,2].includes(t)||this.isLogin)||!!(0==t||1==t&&this.isLogin&&1==this.userInfo.is_promoter||2==t&&this.isLogin&&0==this.userInfo.is_promoter)},shareButtonStyle:function(){var t=s.getMenuButtonBoundingClientRect();return{width:t.height+"px",height:t.height+"px",top:t.top+"px",left:t.left-38+"px"}},menuButtonStyle:function(){var t=s.getMenuButtonBoundingClientRect();return{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:"11px",borderRadius:t.height+"px"}}}),watch:{isLogin:{handler:function(t,e){1==t&&this.getCartCount()},deep:!0}},onLoad:function(t){var e=getCurrentPages();if(this.returnShow=1!==e.length,this.id=t.id,this.isShow=t.isShow,this.fromType=t.fromType,t.scene){var i=this.$util.getUrlParams(decodeURIComponent(t.scene));i.id&&(t.id=i.id),i.spid&&(I.globalData.spid=i.spid)}if(!t.id)return this.showSkeleton=!1,this.$util.Tips({title:"缺少参数无法查看商品"},{tab:3,url:1});this.id=t.id,t.spid&&(I.globalData.spid=t.spid),this.getGoodsDetails()},onReady:function(){this.isNodes++;this.isLogin&&this.$store.state.app.uid},onShareAppMessage:function(){return this.$set(this,"actionSheetHidden",!this.actionSheetHidden),(0,d.userShare)(),{title:this.storeInfo.store_name||"",imageUrl:this.storeInfo.image||"",path:"/pages/goods_details/index?id="+this.id+"&spid="+this.uid}},onShareTimeline:function(){return this.$set(this,"actionSheetHidden",!this.actionSheetHidden),(0,d.userShare)(),{title:this.storeInfo.store_name||"",imageUrl:this.storeInfo.image||"",path:"/pages/goods_details/index?id="+this.id+"&spid="+this.uid}},methods:(r={changeLogin:function(){(0,p.toLogin)()},seeEnsure:function(){this.ensureInfo.show=!0},seeSpecs:function(){this.specsInfo.show=!0},seeDiscount:function(){this.discountInfo.show=!0},moreNav:function(){this.currentPage=!this.currentPage},showImg:function(t){this.$refs.cusPreviewImg.open(this.attrValue)},changeSwitch:function(t){var e=this,i=this.skuArr[t],s=i.suk.split(",");s.forEach((function(t,i){e.$set(e.attr.productAttr[i],"index",s[i])})),i&&(this.$set(this.attr.productSelect,"image",i.image),this.$set(this.attr.productSelect,"price",i.price),this.$set(this.attr.productSelect,"stock",i.stock),this.$set(this.attr.productSelect,"unique",i.unique),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"vip_price",i.vip_price),this.$set(this,"attrValue",i.suk),this.$set(this,"attrTxt","已选择")),this.$refs.productConSwiper.currents=t},qrR:function(t){},boxStatus:function(t){this.showAnimate=t},getpreviewImage:function(){if(this.posterImage){var e=[];e.push(this.posterImage),t.previewImage({urls:e,current:this.posterImage})}else this.$util.Tips({title:"您的海报尚未生成"})},closeChange:function(){this.$set(this.sharePacket,"isState",!0)},goActivity:function(e){var i=e;1==i.type?t.navigateTo({url:"/pages/activity/goods_details/index?id=".concat(i.id,"&type=1&time=").concat(i.time,"&status=1")}):2==i.type?t.navigateTo({url:"/pages/activity/goods_bargain_details/index?id=".concat(i.id,"&spid=").concat(this.uid)}):t.navigateTo({url:"/pages/activity/goods_details/index?id=".concat(i.id,"&type=3")})},iptCartNum:function(t){this.$set(this.attr.productSelect,"cart_num",t)},backTap:function(){var e=getCurrentPages();e.length>1?t.navigateBack():t.switchTab({url:"/pages/index/index"})},getUserInfo:function(){var t=this;(0,d.getUserInfo)().then((function(e){t.$set(t.sharePacket,"isState",0==t.sharePacket.priceName),t.$set(t,"uid",e.data.uid),t.$set(t,"is_money_level",e.data.is_money_level),t.userInfo=e.data}))},ChangeCartNum:function(t){var e=this.productValue[this.attrValue];if(void 0!==e||this.attr.productAttr.length||(e=this.attr.productSelect),void 0!==e){var i=e.stock||0,s=this.attr.productSelect;t?(s.cart_num++,s.cart_num>i&&(this.$set(this.attr.productSelect,"cart_num",i||1),this.$set(this,"cart_num",i||1))):(s.cart_num--,s.cart_num<1&&(this.$set(this.attr.productSelect,"cart_num",1),this.$set(this,"cart_num",1)))}}},(0,a.default)(r,"changeSwitch",(function(t){var e=this,i=this.skuArr[t],s=i.suk.split(",");s.forEach((function(t,i){e.$set(e.attr.productAttr[i],"index",s[i])})),i&&(this.getGoodsCtivity(i.unique),this.$set(this.attr.productSelect,"image",i.image),this.$set(this.attr.productSelect,"price",i.price),this.$set(this.attr.productSelect,"ot_price",i.ot_price),this.$set(this.attr.productSelect,"stock",i.stock),this.$set(this.attr.productSelect,"unique",i.unique),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"vip_price",i.vip_price),this.$set(this,"attrValue",i.suk),this.$set(this,"attrTxt","已选择"),this.attrPicIndex=t)})),(0,a.default)(r,"attrPicIndexs",(function(t){this.attrPicIndex=t})),(0,a.default)(r,"selectSwiper",(function(){this.attrPicIndex=0,this.isSwiper=!0,this.ChangeAttr(this.skuArr[0].suk),this.changeSwitch(0),this.$set(this,"productSwiper",this.storeInfo.slider_image),this.$set(this,"productVideoLink",this.storeInfo.video_link),this.showSkuBox=!1})),(0,a.default)(r,"changeAttrPic",(function(t){var e=[];this.skuArr.forEach((function(t){e.push(t.image)})),this.isSwiper=!1,this.changeSwitch(t),this.$set(this,"productVideoLink",""),this.$set(this,"productSwiper",e),this.showSkuBox=!0,this.scrollToView=48*(t-2)})),(0,a.default)(r,"attrVal",(function(t){this.$set(this.attr.productAttr[t.indexw],"index",this.attr.productAttr[t.indexw].attr_values[t.indexn])})),(0,a.default)(r,"ChangeAttr",(function(t){var e=this.productValue[t];e?e.stock>=0?(this.getGoodsCtivity(e.unique),this.$set(this.attr.productSelect,"sum_price",e.price),this.$set(this.attr.productSelect,"image",e.image),this.$set(this.attr.productSelect,"price",e.price),this.$set(this.attr.productSelect,"ot_price",e.ot_price),this.$set(this.attr.productSelect,"stock",e.stock),this.$set(this.attr.productSelect,"unique",e.unique),this.$set(this.attr.productSelect,"cart_num",this.storeInfo.min_qty?this.storeInfo.min_qty:1),this.$set(this.attr.productSelect,"vip_price",e.vip_price),this.$set(this,"attrValue",t),this.$set(this,"attrTxt","已选择")):(this.getGoodsCtivity(e.unique),this.$set(this.attr.productSelect,"image",this.storeInfo.image),this.$set(this.attr.productSelect,"price",this.storeInfo.price),this.$set(this.attr.productSelect,"ot_price",this.storeInfo.ot_price),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this.attr.productSelect,"cart_num",this.storeInfo.min_qty?this.storeInfo.min_qty:1),this.$set(this.attr.productSelect,"vip_price",this.storeInfo.vip_price),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择")):(this.$set(this.attr.productSelect,"image",this.storeInfo.image),this.$set(this.attr.productSelect,"price",this.storeInfo.price),this.$set(this.attr.productSelect,"ot_price",this.storeInfo.ot_price),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this.attr.productSelect,"cart_num",this.storeInfo.min_qty?this.storeInfo.min_qty:1),this.$set(this.attr.productSelect,"vip_price",this.storeInfo.vip_price),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择"))})),(0,a.default)(r,"getGoodsList",(function(){var t=this,e=this;(0,u.getProductRecommend)(e.id).then((function(t){e.good_list=t.data||[]})).catch((function(e){return t.$util.Tips({title:e})}))})),(0,a.default)(r,"getGoodsCtivity",(function(t){var e=this,i=this;(0,u.getProductCtivity)(i.id,{unique:t||""}).then((function(t){i.$set(i,"activityBg",t.data.activity_background.image||""),i.$set(i,"activity",t.data.activity?t.data.activity:[]),i.$set(i,"discountsData",t.data.discounts_products?t.data.discounts_products:[]);var s=t.data.promotions[0];if(t.data.promotions.length){var o=i.$util.$h.Div(s.discount,100),r=i.$util.$h.Mul(o,e.storeInfo.price);i.$set(i.limitInfo,"price",e.storeInfo.price||0),i.$set(i.limitInfo,"datatime",s.stop_time||0),i.$set(i.limitInfo,"discount",o),i.$set(i.limitInfo,"discount_price",r)}i.$set(i.discountInfo,"discount",t.data.promotions),t.data.coupons.map((function(t){e.$set(t,"ruleshow",!1)})),i.$set(i.coupon,"list",t.data.coupons),i.$set(i,"computedPrice",t.data.computed),i.$set(e.attr.productSelect,"pay_price",t.data.computed.deduction.pay_price),i.showSkeleton=!1})).catch((function(t){return e.$util.Tips({title:t})}))})),(0,a.default)(r,"getGoodsDetails",(function(){var e=this,i=this;(0,u.getProductDetail)(i.id).then((function(s){var o=s.data.storeInfo;i.$set(i,"storeInfo",o),e.storeInfo=o,e.brokerage=s.data.brokerage,e.productSwiper=o.slider_image,e.productVideoLink=o.video_link,e.description=o.description.replace(/<img/gi,'<img style="max-width: 100%;display:block;"'),e.$set(e.ensureInfo,"ensure",o.ensure);var r=o.ensure.map((function(t){return t.name})).join(" · "),n=o.specs.map((function(t){return t.name})).join(" · ");e.$set(e.ensureInfo,"ensureTitle",r),e.$set(e.storeInfo,"specsTitle",n),e.$set(e.specsInfo,"specs",o.specs),e.$set(e.attr,"productAttr",s.data.productAttr),e.$set(e,"productValue",s.data.productValue),e.skuArr=Object.values(s.data.productValue).sort((function(t,e){return t.suk.localeCompare(e.suk)})),e.skuArr.length||(e.skuArr=[{image:e.storeInfo.image,suk:e.storeInfo.store_name,price:e.storeInfo.price}]),i.$set(i,"is_vip",s.data.storeInfo.is_vip),i.siteName=s.data.site_name,i.posterTitle=s.data.product_poster_title,i.$set(i,"reply",s.data.reply),i.$set(i,"communityList",s.data.elegant_list),i.$set(i,"communityCount",s.data.elegant_count),i.$set(i,"replyCount",s.data.replyCount),i.$set(i,"replyChance",s.data.replyChance),i.$set(i.sharePacket,"priceName",s.data.priceName),i.$set(i,"storeSelfMention",s.data.store_self_mention),i.$set(i,"shareQrcode",s.data.share_qrcode),i.$set(i,"routineContact",Number(s.data.routine_contact_type)),t.setNavigationBarTitle({title:o.store_name.substring(0,13)+"..."}),i.$set(i,"diff",i.$util.$h.Sub(o.price,o.vip_price)),i.getGoodsList(),i.isLogin&&i.getUserInfo(),i.DefaultSelect(),i.getCartCount(),i.preloadImage()})).catch((function(t){return i.$util.Tips({title:t.toString()},{tab:3,url:1})}))})),(0,a.default)(r,"preloadImage",(function(){t.downloadFile({url:this.imgHost+"/statics/images/poster_loading.png"})})),(0,a.default)(r,"DefaultSelect",(function(){var t=this.attr.productAttr,e=[];if(this.storeInfo.default_sku)e=this.storeInfo.default_sku.split(",");else for(var i in this.productValue)if(this.productValue[i].stock>0){e=this.attr.productAttr.length?i.split(","):[];break}for(var s=0;s<t.length;s++)this.$set(t[s],"index",e[s]);var o=this.productValue[e.join(",")];this.$set(this.attr.productSelect,"store_name",this.storeInfo.store_name),o&&t.length?(this.getGoodsCtivity(o.unique),this.$set(this.attr.productSelect,"image",o.image),this.$set(this.attr.productSelect,"price",o.price),this.$set(this.attr.productSelect,"ot_price",o.ot_price),this.$set(this.attr.productSelect,"stock",o.stock),this.$set(this.attr.productSelect,"unique",o.unique),this.$set(this.attr.productSelect,"cart_num",this.storeInfo.min_qty?this.storeInfo.min_qty:1),this.$set(this,"attrValue",e.join(",")),this.$set(this.attr.productSelect,"vip_price",o.vip_price),this.$set(this,"attrTxt","已选择")):!o&&t.length?(this.getGoodsCtivity(),this.$set(this.attr.productSelect,"image",this.storeInfo.image),this.$set(this.attr.productSelect,"price",this.storeInfo.price),this.$set(this.attr.productSelect,"ot_price",this.storeInfo.ot_price),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this.attr.productSelect,"cart_num",this.storeInfo.min_qty?this.storeInfo.min_qty:1),this.$set(this.attr.productSelect,"vip_price",this.storeInfo.vip_price),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择")):o||t.length||(this.getGoodsCtivity(),this.$set(this.attr.productSelect,"image",this.storeInfo.image),this.$set(this.attr.productSelect,"price",this.storeInfo.price),this.$set(this.attr.productSelect,"ot_price",this.storeInfo.ot_price),this.$set(this.attr.productSelect,"stock",this.storeInfo.stock),this.$set(this.attr.productSelect,"unique",this.storeInfo.unique||""),this.$set(this.attr.productSelect,"cart_num",this.storeInfo.min_qty?this.storeInfo.min_qty:1),this.$set(this.attr.productSelect,"vip_price",this.storeInfo.vip_price),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择"))})),(0,a.default)(r,"openPerferentDrawer",(function(){this.showPerferentDrawer=!0})),(0,a.default)(r,"setCollect",(0,m.Debounce)((function(){if(!1===this.isLogin)(0,p.toLogin)();else{var t=this;this.storeInfo.userCollect?(0,u.collectDel)(this.storeInfo.id).then((function(e){return t.$set(t.storeInfo,"userCollect",!t.storeInfo.userCollect),t.$util.Tips({title:e.msg})})):(0,u.collectAdd)(this.storeInfo.id).then((function(e){return t.$set(t.storeInfo,"userCollect",!t.storeInfo.userCollect),t.$util.Tips({title:e.msg})}))}}))),(0,a.default)(r,"selecAttr",(function(){this.currentPage=!1,this.$set(this.attr,"cartAttr",!0),this.$set(this,"isOpen",!0)})),(0,a.default)(r,"onMyEvent",(function(){this.$set(this.attr,"cartAttr",!1),this.$set(this,"isOpen",!1)})),(0,a.default)(r,"myEnsure",(function(){this.$set(this.ensureInfo,"show",!1)})),(0,a.default)(r,"mySpecs",(function(){this.$set(this.specsInfo,"show",!1)})),(0,a.default)(r,"myDiscount",(function(){this.$set(this.discountInfo,"show",!1)})),(0,a.default)(r,"onConfirm",(function(){this.$set(this.attr,"cartAttr",!1),this.isOpen=!0,"cart"==this.cartType?this.goCat(void 0,"cart"):this.goCat(!0,"buy")})),(0,a.default)(r,"joinCart",(function(t){this.currentPage=!1,this.isLogin?this.goCat(void 0,"cart"):(0,p.toLogin)()})),(0,a.default)(r,"goCat",(function(e,i){var s=this,o=s.productValue[this.attrValue];if(this.cartType=i,s.attrValue?s.attr.cartAttr=!s.isOpen:s.isOpen?s.attr.cartAttr=!0:s.attr.cartAttr=!s.attr.cartAttr,!0===s.attr.cartAttr&&!1===s.isOpen)return s.isOpen=!0;if(s.attr.productAttr.length&&void 0===o&&!0===s.isOpen)return s.$util.Tips({title:"产品库存不足，请选择其它属性"});if(s.attr.productSelect.cart_num<=0)return s.attr.productSelect.cart_num=1,s.isOpen=!1,s.$util.Tips({title:"请先选择属性"});var r={productId:s.id,cartNum:s.attr.productSelect.cart_num,new:void 0===e?0:1,uniqueId:void 0!==s.attr.productSelect?s.attr.productSelect.unique:""};(0,u.postCartAdd)(r).then((function(i){s.isOpen=!1,s.attr.cartAttr=!1,e?s.computedPrice.coupon&&s.computedPrice.coupon.id?null==s.computedPrice.coupon.used?(0,h.setCouponReceive)(s.computedPrice.coupon.id).then((function(e){t.navigateTo({url:"/pages/goods/order_confirm/index?new=1&cartId="+i.data.cartId+"&couponId="+e.data.id+"&couponTitle="+s.computedPrice.coupon.coupon_title})})).catch((function(e){t.navigateTo({url:"/pages/goods/order_confirm/index?new=1&cartId="+i.data.cartId})})):t.navigateTo({url:"/pages/goods/order_confirm/index?new=1&cartId="+i.data.cartId+"&couponId="+s.computedPrice.coupon.id+"&couponTitle="+s.computedPrice.coupon.coupon_title}):t.navigateTo({url:"/pages/goods/order_confirm/index?new=1&cartId="+i.data.cartId}):s.$util.Tips({title:"添加购物车成功",success:function(){s.cartNum=i.data.cartNum,s.getCartCount(!0)}})})).catch((function(t){return s.isOpen=!1,s.$util.Tips({title:t})}))})),(0,a.default)(r,"getCartCount",(function(t){var e=this,i=this,s=i.isLogin;s&&(0,l.getCartCounts)().then((function(s){i.CartCount=s.data.count,e.$store.commit("indexData/setCartNum",i.CartCount+""),t&&(i.animated=!0,setTimeout((function(){i.animated=!1}),500))}))})),(0,a.default)(r,"goBuy",(function(t){this.currentPage=!1,this.isLogin?this.goCat(!0,"buy"):(0,p.toLogin)()})),(0,a.default)(r,"listenerActionSheet",(function(){this.onMyEvent(),this.currentPage=!1,this.posters=!0,this.goPoster()})),(0,a.default)(r,"listenerActionClose",(function(){this.posters=!1})),(0,a.default)(r,"posterImageClose",(function(){this.posterImageStatus=!1,this.posters=!1})),(0,a.default)(r,"setDomain",(function(t){return t=t?t.toString():"",t.indexOf("https://")>-1?t:t.replace("http://","https://")})),(0,a.default)(r,"downloadFileImage",(function(e){return e=this.setDomain(e),new Promise((function(i,s){t.downloadFile({url:e,success:function(t){i(t.tempFilePath)},fail:function(t){}})}))})),(0,a.default)(r,"goPoster",(function(){var t=this;return(0,c.default)(n.default.mark((function e(){var i,s,o,r,c,a;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t,e.next=3,t.downloadFileImage(t.storeInfo.image);case 3:return s=e.sent,e.next=6,t.downloadFileImage(t.imgHost+"/statics/images/product/posterbackgd.png");case 6:return o=e.sent,e.next=9,(0,u.getProductCode)(i.id);case 9:if(r=e.sent,r.data.code){e.next=13;break}return t.posters=!1,e.abrupt("return",i.$util.Tips({title:"小程序二维码需要发布正式版后才能获取到"}));case 13:return e.next=15,t.downloadFileImage(r.data.code);case 15:c=e.sent,i.$set(i,"canvasStatus",!0),a=[o,s,c],i.$nextTick((function(){setTimeout((function(){i.$util.PosterCanvas(i.fontColor,i.themeColor,i.siteName,a,i.storeInfo.store_name,i.storeInfo.price,i.storeInfo.ot_price,i.posterTitle,(function(t){i.$set(i,"posterImage",t),i.$set(i,"posterImageStatus",!0),i.$set(i,"canvasStatus",!1),i.$set(i,"actionSheetHidden",!i.actionSheetHidden)}))}),1e3)}));case 19:case"end":return e.stop()}}),e)})))()})),(0,a.default)(r,"savePosterPath",(function(){var e=this;t.getSetting({success:function(i){i.authSetting["scope.writePhotosAlbum"]?t.saveImageToPhotosAlbum({filePath:e.posterImage,success:function(t){e.posterImageClose(),e.$util.Tips({title:"保存成功",icon:"success"})},fail:function(t){e.$util.Tips({title:"保存失败"})}}):t.authorize({scope:"scope.writePhotosAlbum",success:function(){t.saveImageToPhotosAlbum({filePath:e.posterImage,success:function(t){e.posterImageClose(),e.$util.Tips({title:"保存成功",icon:"success"})},fail:function(t){e.$util.Tips({title:"保存失败"})}})}})}})})),(0,a.default)(r,"goDiscounts",(function(){t.navigateTo({url:"/pages/goods_details/discountsGoodsList?id="+this.id})})),(0,a.default)(r,"goPage",(function(e,i){1==e?t.navigateTo({url:i}):2==e?t.switchTab({url:i}):3==e&&t.navigateBack()})),(0,a.default)(r,"ChangCouponsUseState",(function(t){this.coupon.list[t].is_use=!0,this.$set(this.coupon,"list",this.coupon.list),this.$set(this.coupon,"coupon",!1)})),(0,a.default)(r,"ChangCoupons",(function(t){})),(0,a.default)(r,"ruleToggle",(function(t){this.coupon.list[t].ruleshow=!this.coupon.list[t].ruleshow})),(0,a.default)(r,"goGoodCall",(function(){var t={};t="string"===typeof this.userInfo?JSON.parse(this.userInfo):this.userInfo;var e="/pages/extension/customer_list/chat?productId=".concat(this.id),i={store_name:this.storeInfo.store_name,path:"/pages/goods_details/index?id=".concat(this.storeInfo.id),image:this.storeInfo.image};this.$util.getCustomer(t,e,i,1)})),(0,a.default)(r,"copyShare",(function(){t.setClipboardData({data:this.storeInfo.share_content||this.storeInfo.store_name,success:function(){t.showToast({title:"复制成功，快去分享吧",icon:"none"})}})})),(0,a.default)(r,"borkerageShare",(function(){this.isLogin?this.userInfo.is_promoter?t.navigateTo({url:"/pages/goods/goodsShare/index?id="+this.id}):0==this.userInfo.is_promoter&&1==this.storeBrokerageStatus?t.navigateTo({url:"/pages/users/distributor/apply"}):0==this.userInfo.is_promoter&&3==this.storeBrokerageStatus&&t.navigateTo({url:"/pages/users/distributor/index"}):(0,p.toLogin)()})),r),onPageScroll:function(e){this.$set(this,"currentPage",!1),e.scrollTop>340?this.pageScrollStatus=!0:e.scrollTop<340&&(this.pageScrollStatus=!1),t.$emit("scroll")}};e.default=y}).call(this,i("df3c")["default"],i("3223")["default"])},6813:function(t,e,i){"use strict";var s=i("ffb9"),o=i.n(s);o.a},"71af":function(t,e,i){"use strict";i.r(e);var s=i("3883"),o=i.n(s);for(var r in s)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(r);e["default"]=o.a},d42b:function(t,e,i){"use strict";i.r(e);var s=i("2d99"),o=i("71af");for(var r in o)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(r);i("6813");var n=i("828b"),c=Object(n["a"])(o["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],void 0);e["default"]=c.exports},e5b9:function(t,e,i){"use strict";(function(t,e){var s=i("47a9");i("f076");s(i("3240"));var o=s(i("d42b"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},ffb9:function(t,e,i){}},[["e5b9","common/runtime","common/vendor"]]]);