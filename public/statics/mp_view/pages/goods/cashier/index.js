require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/cashier/index"],{4070:function(t,e,a){"use strict";a.r(e);var i=a("4cb8"),r=a("f1f7");for(var n in r)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("dd99");var o=a("828b"),s=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);e["default"]=s.exports},"4cb8":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){}));var i=function(){var t=this.$createElement;this._self._c},r=[]},"63d4":function(t,e,a){},"6ccb":function(t,e,a){"use strict";(function(t){var i=a("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(a("7ca3")),n=i(a("89cc")),o=a("606e"),s=a("92f9"),c=a("4d38"),u={data:function(){var t;return t={invalidTime:0,checked:!1,orderId:0,fromType:"",active:-1,payPrice:0,payPriceShow:0,now_money:"",payPostage:0,offlinePostage:!1},(0,r.default)(t,"invalidTime",0),(0,r.default)(t,"initIn",!1),(0,r.default)(t,"jumpData",{orderId:"",msg:""}),(0,r.default)(t,"formContent",""),(0,r.default)(t,"cartArr",[{name:"微信支付",icon:c.HTTP_REQUEST_URL+"/statics/images/order/wx_pay.png",value:"weixin",title:"使用微信快捷支付",payStatus:1},{name:"支付宝支付",icon:c.HTTP_REQUEST_URL+"/statics/images/order/alipay.png",value:"alipay",title:"使用线上支付宝支付",payStatus:1},{name:"余额支付",icon:c.HTTP_REQUEST_URL+"/statics/images/order/yue_pay.png",value:"yue",title:"可用余额:",payStatus:1},{name:"线下支付",icon:c.HTTP_REQUEST_URL+"/statics/images/order/xianxia_pay.png",value:"offline",title:"选择线下付款方式",payStatus:2}]),(0,r.default)(t,"paytype",""),(0,r.default)(t,"isShow",!1),t},mixins:[n.default],components:{countDown:function(){a.e("components/countDown/index").then(function(){return resolve(a("1706"))}.bind(null,a)).catch(a.oe)}},computed:{payTypeList:function(){var t=[];return this.cartArr.forEach((function(e){1==e.payStatus&&t.push(e)})),t.length&&this.payType(t[0].value,0),t}},onLoad:function(t){t.order_id&&(this.orderId=t.order_id),t.from_type&&(this.fromType=t.from_type),this.getCashierOrder()},methods:{payType:function(t,e){this.active=e,this.paytype=t,this.offlinePostage&&(this.payPriceShow="offline"==t?this.$util.$h.Sub(this.payPrice,this.payPostage):this.payPrice)},getCashierOrder:function(){var e=this;(0,o.getCashierOrder)(this.orderId,this.fromType).then((function(t){e.isShow=!0,e.cartArr[0].payStatus=t.data.pay_weixin_open||0,e.cartArr[1].payStatus=0,e.cartArr[2].payStatus=t.data.yue_pay_status,e.now_money=t.data.now_money,1==t.data.offline_pay_status?e.cartArr[3].payStatus=1:e.cartArr[3].payStatus=0,e.payPrice=e.payPriceShow=t.data.pay_price,e.invalidTime=t.data.invalid_time,e.payPostage=t.data.pay_postage,e.getShowPay()})).catch((function(a){return e.isShow=!0,t.hideLoading(),e.$util.Tips({title:a})}))},getShowPay:function(){var t=this.cartArr.every((function(t){return 0==t.payStatus||2==t.payStatus}));if(t&&["vip","recharge"].includes(this.fromType))return this.$util.Tips({title:"未开启线上支付，请联系管理员"},{tab:3})},goPay:function(){var e=this,a=this;if(-1==a.active)return a.$util.Tips({title:"请选择付款方式"});if(!a.orderId)return a.$util.Tips({title:"请选择要支付的订单"});if("yue"==a.paytype&&parseFloat(this.now_money)<parseFloat(a.payPriceShow))return a.$util.Tips({title:"余额不足"});t.showLoading({title:"支付中"});var i="";"order"==this.fromType?i=(0,o.orderPay)({uni:a.orderId,paytype:a.paytype,from:"routine"}):"recharge"==this.fromType?i=(0,s.rechargePayAPi)({uni:this.orderId,paytype:a.paytype,from:"routine"}):"vip"==this.fromType&&(i=(0,s.memberCardPayApi)({uni:this.orderId,paytype:this.paytype,from:"routine"})),i.then((function(a){var i=a.data.status,r=(a.data.result.order_id,a.data.result.jsConfig),n={order:"/pages/goods/order_pay_status/index?order_id="+e.orderId+"&msg="+a.msg+"&type=3&totalPrice="+e.payPriceShow,recharge:"/pages/users/user_payment/index",vip:"/pages/annex/vip_paid/index"},o=n[e.fromType];switch(i){case"ORDER_EXIST":case"EXTEND_ORDER":case"PAY_ERROR":e.pageReject(a.msg,o);break;case"SUCCESS":e.pageReject(a.msg,o);break;case"WECHAT_PAY":e.wechatPayFun(r,o);break;case"PAY_DEFICIENCY":t.hideLoading(),e.pageReject(a.msg,o);break;case"WECHAT_H5_PAY":t.hideLoading(),setTimeout((function(){location.href=a.data.result.jsConfig.mweb_url+"&redirect_url="+window.location.protocol+"//"+window.location.host+o}),500);break;case"ALIPAY_PAY":break}})).catch((function(e){return t.hideLoading(),a.$util.Tips({title:e})}))},wechatPayFun:function(e,a){var i=this;t.requestPayment({timeStamp:e.timestamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign,success:function(t){i.pageReject("支付成功",a)},fail:function(t){i.pageReject("支付失败",a)}})},pageReject:function(e,a){return t.hideLoading(),this.$util.Tips({title:e},{tab:5,url:a})}}};e.default=u}).call(this,a("df3c")["default"])},d474:function(t,e,a){"use strict";(function(t,e){var i=a("47a9");a("f076");i(a("3240"));var r=i(a("4070"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(r.default)}).call(this,a("3223")["default"],a("df3c")["createPage"])},dd99:function(t,e,a){"use strict";var i=a("63d4"),r=a.n(i);r.a},f1f7:function(t,e,a){"use strict";a.r(e);var i=a("6ccb"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a}},[["d474","common/runtime","common/vendor"]]]);