require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/order_list/index"],{"0bf6":function(t,e,i){"use strict";i.r(e);var o=i("e4cb"),r=i.n(o);for(var n in o)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(n);e["default"]=r.a},"3f7f":function(t,e,i){"use strict";var o=i("6c6e"),r=i.n(o);r.a},"53df":function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return o}));var o={uniBadge:function(){return i.e("uni_modules/uni-badge/components/uni-badge/uni-badge").then(i.bind(null,"4d28"))},easyLoadimage:function(){return i.e("components/easy-loadimage/easy-loadimage").then(i.bind(null,"94dd"))}},r=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.orderList,(function(e,i){var o=t.__get_orig(e),r=e.refund.length,n=e.cartInfo.length&&1==e.cartInfo.length,a=e.cartInfo.length&&e.cartInfo.length>1;return{$orig:o,g0:r,g1:n,g2:a}}))),o=0==t.orderList.length&&!t.loading,r=t.orderList.length;t.$mp.data=Object.assign({},{$root:{l0:i,g3:o,g4:r}})},n=[]},"6c6e":function(t,e,i){},d7ea:function(t,e,i){"use strict";i.r(e);var o=i("53df"),r=i("0bf6");for(var n in r)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return r[t]}))}(n);i("3f7f");var a=i("828b"),s=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,"202e01f6",null,!1,o["a"],void 0);e["default"]=s.exports},da44:function(t,e,i){"use strict";(function(t,e){var o=i("47a9");i("f076");o(i("3240"));var r=o(i("d7ea"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(r.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},e4cb:function(t,e,i){"use strict";(function(t){var o=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(i("af34")),n=o(i("7ca3")),a=i("606e"),s=i("7391"),d=i("5088"),c=i("8f59"),u=o(i("89cc"));function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){(0,n.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var f=t.getWindowInfo().statusBarHeight,g={components:{Loading:function(){i.e("components/Loading/index").then(function(){return resolve(i("e83c"))}.bind(null,i)).catch(i.oe)},emptyPage:function(){i.e("components/emptyPage").then(function(){return resolve(i("398a"))}.bind(null,i)).catch(i.oe)},tuiModal:function(){i.e("components/tui-modal/index").then(function(){return resolve(i("6b9f"))}.bind(null,i)).catch(i.oe)}},mixins:[u.default],data:function(){return{sysHeight:f,loaded:!1,loading:!1,loadend:!1,loadTitle:"加载更多",orderList:[],orderData:{},orderStatus:"",orderType:"",page:1,limit:20,pay_close:!1,pay_order_id:"",totalPrice:"0",isAuto:!1,isShowAuth:!1,keyword:"",marTop:0,focus:!1,historyList:[],tempStorage:[],showModal:!1,modalTitle:"",modalContent:"",modalType:0,orderId:""}},computed:h(h({},(0,c.mapGetters)(["isLogin"])),{},{fixedTop:function(){return this.sysHeight+"px"}}),onShow:function(){t.removeStorageSync("form_type_cart"),this.page=1,this.loadend=!1,this.orderList=[],this.isLogin?this.getFun():(0,d.toLogin)()},onPageScroll:function(e){t.$emit("scroll")},onLoad:function(t){t.status&&(this.orderStatus=void 0==t.status&&0!=t.status?"":parseInt(t.status)),t.type&&(this.orderType=void 0==t.type&&0!=t.type?"":parseInt(t.type)),this.getMarTop()},methods:{getFun:function(){this.getOrderData(),this.getOrderList()},onLoadFun:function(){this.getFun(),this.isShowAuth=!1},getMarTop:function(){var e=this,i=this;setTimeout((function(){var o=t.createSelectorQuery().in(e).select(".header_box");o.boundingClientRect((function(t){i.marTop=t.height})).exec()}),100)},getOrderData:function(){var t=this;(0,a.orderData)({type:this.orderType}).then((function(e){t.$set(t,"orderData",e.data)}))},showModalChange:function(t,e){this.orderId=t,this.modalType=e,1==e?(this.modalTitle="确认收货",this.modalContent="为保障权益，请收到货确认无误后，再确认收货"):2==e?(this.modalTitle="删除订单",this.modalContent="确定删除该订单?"):3==e&&(this.modalTitle="温馨提示",this.modalContent="确认取消该订单?"),this.showModal=!0},handleClick:function(t){var e=this,i=t.index;1==i?1==this.modalType?orderTake(this.orderId).then((function(t){e.showModal=!1,e.goSearch(""),e.getOrderData()})).catch((function(t){return e.$util.Tips({title:t})})):2==this.modalType?(0,a.orderDel)(this.orderId).then((function(t){e.showModal=!1,e.goSearch(""),e.getOrderData()})):3==this.modalType&&(this.showModal=!1,(0,a.orderCancel)(this.orderId).then((function(){e.goSearch(""),e.getOrderData()}))):this.showModal=!1},hideModal:function(){this.showModal=!1},cancelOrder:function(t,e){var i=this;if(!e)return i.$util.Tips({title:"缺少订单号无法取消订单"});(0,a.orderCancel)(e).then((function(e){return i.$util.Tips({title:e.msg,icon:"success"},(function(){i.orderList.splice(t,1),i.$set(i,"orderList",i.orderList),i.$set(i.orderData,"unpaid_count",i.orderData.unpaid_count-1),i.getOrderData()}))})).catch((function(t){return i.$util.Tips({title:t})}))},goPay:function(e){t.redirectTo({url:"/pages/goods/cashier/index?order_id=".concat(e,"&from_type=order")})},goOrderDetails:function(e){if(!e)return that.$util.Tips({title:"缺少订单号无法查看订单详情"});t.showLoading({title:"正在加载"}),(0,s.openOrderSubscribe)().then((function(){t.hideLoading(),t.navigateTo({url:"/pages/goods/order_details/index?order_id="+e})})).catch((function(e){t.hideLoading()}))},statusClick:function(t){this.loading||t!==this.orderStatus&&(this.orderStatus=t,this.loadend=!1,this.page=1,this.$set(this,"orderList",[]),this.getOrderList())},searchFocus:function(){try{this.historyList=[],this.tempStorage=[];var e=t.getStorageSync("orderHistoryList");e.length>0?this.historyList=Array.from(new Set(e)):this.historyList=[],this.tempStorage=this.historyList}catch(i){}this.focus=!0},goSearch:function(t){this.loadend=!1,this.loading=!1,this.keyword=t,this.page=1,this.orderList=[],this.getOrderList()},inputConfirm:function(){var e=this;this.loadend=!1,this.loading=!1,this.page=1,this.orderList=[],this.getOrderList(),setTimeout((function(i){var o=e.tempStorage;""!==e.keyword&&(o.unshift(e.keyword),e.tempStorage=(0,r.default)(Array.from(new Set(o))),t.setStorageSync("orderHistoryList",e.tempStorage))}),1e3)},getOrderList:function(){var t=this;t.loadend||t.loading||(t.loading=!0,t.loadTitle="加载更多",(0,a.getOrderList)({status:t.orderStatus,type:t.orderType,page:t.page,limit:t.limit,search:this.keyword}).then((function(e){var i=e.data||[],o=i.length<t.limit;t.orderList=t.$util.SplitArray(i,t.orderList),t.$set(t,"orderList",t.orderList),t.loadend=o,t.loading=!1,t.loadTitle=o?"没有更多内容啦~":"加载更多",t.page=t.page+1,t.focus=!1})).catch((function(e){t.loading=!1,t.loadTitle="加载更多"})))},delOrder:function(e,i){var o=this;t.showModal({title:"删除订单",content:"确定删除该订单",success:function(t){if(t.confirm)(0,a.orderDel)(e).then((function(t){return o.orderList.splice(i,1),o.$set(o,"orderList",o.orderList),o.$set(o.orderData,"unpaid_count",o.orderData.unpaid_count-1),o.getOrderData(),o.$util.Tips({title:"删除成功",icon:"success"})})).catch((function(t){return o.$util.Tips({title:t})}));else if(t.cancel)return o.$util.Tips({title:"已取消"})}})},goPage:function(e,i){if(1==e)t.navigateTo({url:i});else if(2==e)t.switchTab({url:i});else if(3==e){var o=getCurrentPages();o.length>1?t.navigateBack():t.switchTab({url:"/pages/index/index"})}}},onReachBottom:function(){this.getOrderList()}};e.default=g}).call(this,i("df3c")["default"])}},[["da44","common/runtime","common/vendor"]]]);