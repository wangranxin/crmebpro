require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/goods_list/index"],{"0181":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return r}));var r={easyLoadimage:function(){return i.e("components/easy-loadimage/easy-loadimage").then(i.bind(null,"94dd"))},uniBadge:function(){return i.e("uni_modules/uni-badge/components/uni-badge/uni-badge").then(i.bind(null,"4d28"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,[1,2].includes(t.stock)),r=[1,2].includes(t.price),o=t.promotionList.length&&!t.cateSearch||t.where.promotions_id,n=0==t.is_switch?t.__map(t.tempArr,(function(e,i){var r=t.__get_orig(e),o=Number(e.vip_price);return{$orig:r,m0:o}})):null,s=0==t.is_switch?t.tempArr.length:null,a=0==t.tempArr.length&&t.where.page>1,c=t.promotionList.length&&t.where.promotions_id,h=c&&t.discountInfo.deduction.sum_price?t.$util.$h.Sub(t.discountInfo.deduction.sum_price,t.discountInfo.deduction.pay_price):null;t._isMounted||(t.e0=function(e){t.showFilterDrawer=!0},t.e1=function(e){t.showFilterDrawer=!0},t.e2=function(){t.showFilterDrawer=!1},t.e3=function(e){t.showSortAbleBox=!1}),t.$mp.data=Object.assign({},{$root:{g0:i,g1:r,g2:o,l0:n,g3:s,g4:a,g5:c,g6:h}})},n=[]},"14a9":function(t,e,i){"use strict";(function(t){var r=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(i("7ca3")),n=i("0f73"),s=i("606e"),a=(i("5088"),i("8f59")),c=i("95b5"),h=r(i("89cc")),d=r(i("018e")),u=i("4d38");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}var p=t.getWindowInfo().statusBarHeight,f={computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){(0,o.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},(0,a.mapGetters)(["uid","isLogin"])),components:{recommend:function(){Promise.all([i.e("common/vendor"),i.e("components/recommend/index")]).then(function(){return resolve(i("a60c"))}.bind(null,i)).catch(i.oe)},homeList:function(){i.e("components/homeList/index").then(function(){return resolve(i("7052"))}.bind(null,i)).catch(i.oe)},waterfallsFlow:function(){i.e("components/WaterfallsFlow/WaterfallsFlow").then(function(){return resolve(i("33ab"))}.bind(null,i)).catch(i.oe)},productWindow:function(){i.e("components/productWindow/index").then(function(){return resolve(i("bae9"))}.bind(null,i)).catch(i.oe)},filterDrawer:function(){i.e("pages/goods/components/filterDrwer/index").then(function(){return resolve(i("c236"))}.bind(null,i)).catch(i.oe)},emptyPage:function(){i.e("components/emptyPage").then(function(){return resolve(i("398a"))}.bind(null,i)).catch(i.oe)},cartList:function(){i.e("components/cartList/index").then(function(){return resolve(i("ef91a"))}.bind(null,i)).catch(i.oe)}},mixins:[h.default,d.default],data:function(){return{id:0,productValue:[],is_vip:0,attr:{cartAttr:!1,productAttr:[],productSelect:{}},attrValue:"",storeName:"",sysHeight:p,goodList:!0,currentPage:!1,tempArr:[],is_switch:!0,where:{sid:0,keyword:"",priceOrder:"",salesOrder:"",news:0,page:1,limit:10,cid:0,tid:0,brand_id:"",promotions_id:0,promotions_type:0,defaultOrder:0},price:0,stock:0,nows:!1,loadend:!1,loading:!1,loadTitle:"加载更多",title:"",hostProduct:[],hotPage:1,hotLimit:10,hotScroll:!1,brandList:[],promotionList:[],labelList:[],filterCateList:[],storeInfo:{},totalPrice:0,promotionsInfo:{},totalNum:0,imgHost:u.HTTP_REQUEST_URL,isShowAuth:!1,marTop:"",showFilterDrawer:!1,cateSearch:!1,showSortAbleBox:!1,sortableShowTab:[{title:"综合排序",value:0},{title:"好评优先",value:1},{title:"新品优先",value:2}],cartData:{cartList:[],iScart:!1},cart_num:0,discountInfo:{deduction:{}}}},onLoad:function(t){this.where.cid=t.cid||0,this.$set(this.where,"sid",t.sid||0),this.$set(this.where,"tid",t.tid||0),this.title=t.title||"",this.$set(this.where,"keyword",t.searchValue||""),this.$set(this.where,"productId",t.productId||""),this.$set(this.where,"brand_id",t.brandId||0),t.promotions_type&&(this.where.promotions_type=t.promotions_type,this.where.promotions_id=t.promotions_id),t.sid&&0!=t.sid&&(this.cateSearch=!0,this.getProCate()),this.getSearchFilter()},created:function(){var t=this;this.$eventHub.$on("onCartAddChange",(function(e){e.spec_type?t.goCartDuo(e):t.goCartDan(e,0)}))},methods:{addCartTap:function(t){t.spec_type?this.goCartDuo(t):this.goCartDan(t,0,!0)},getCartCompute:function(t){var e=this;(0,s.cartCompute)({cartId:t}).then((function(t){e.discountInfo.deduction=t.data.deduction})).catch((function(t){e.$util.Tips({title:t})}))},getTotalPrice:function(){var t=this;(0,s.vcartList)().then((function(e){if(e.data.length){var i=e.data.map((function(t){return t.id})).join(",");t.getCartCompute(i)}}))},getCartList:function(t){var e=this,i=this;(0,s.vcartList)().then((function(r){if(i.$set(i.cartData,"cartList",r.data),r.data.length){i.$set(i.cartData,"iScart",!t&&!i.cartData.iScart);var o=r.data.map((function(t){return t.id})).join(",");i.getCartCompute(o)}else i.$set(i.cartData,"iScart",!1);r.data.length||(e.$store.commit("indexData/setCartNum",0),e.tempArr.forEach((function(t){t.cart_num=0})))}))},getCartNum:function(){var t=this;(0,s.getCartCounts)().then((function(e){t.cart_num=e.data.count,t.$store.commit("indexData/setCartNum",e.data.count)}))},goCart:function(){this.where.promotions_type?t.switchTab({url:"/pages/order_addcart/order_addcart"}):t.switchTab({url:"/pages/goods_cate/goods_cate"})},getAttrs:function(e){var i=this;(0,n.getAttr)(e,0).then((function(e){t.hideLoading(),i.$set(i.attr,"productAttr",e.data.productAttr),i.$set(i,"productValue",e.data.productValue),i.$set(i,"is_vip",e.data.storeInfo.is_vip),i.$set(i,"storeInfo",e.data.storeInfo),i.DefaultSelect()}))},getProCate:function(){var t=this;(0,n.levelCategoryApi)({id:this.where.sid}).then((function(e){t.filterCateList=e.data}))},getSearchFilter:function(){var t=this,e={keyword:this.where.keyword,cid:this.where.cid,sid:this.where.sid,tid:this.where.tid,productId:this.where.productId,promotions_type:this.where.promotions_type};(0,n.searchFilterApi)(e).then((function(e){t.brandList=e.data.brand,t.labelList=e.data.store_label,t.promotionList=e.data.promotions,e.data.promotions.length&&(t.where.promotions_id=t.promotionList[0].id,t.isLogin&&(t.getCartList(1),t.getCartNum()),t.getProductList()),t.getMarTop()})).catch((function(e){return t.$util.Tips({title:e.msg})}))},toggleSortable:function(){this.showSortAbleBox=!this.showSortAbleBox},checkSortable:function(t){this.where.defaultOrder=t,this.showSortAbleBox=!1,this.loadend=!1,this.$set(this.where,"page",1),this.getProductList(!0)},promotionTap:function(t){this.where.promotions_id=0==this.where.promotions_id?t.id:0,this.loadend=!1,this.$set(this.where,"page",1),this.getProductList(!0)},clearWord:function(){this.where.keyword=""},cateCheck:function(t){this.where.sid=t.id,this.loadend=!1,this.$set(this.where,"page",1),this.getProductList(!0)},filterConfirm:function(t){this.showFilterDrawer=!1,Object.assign(this.where,t),this.loadend=!1,this.$set(this.where,"page",1),this.getProductList(!0)},goDetail:function(e){this.currentPage=!1,(0,c.goShopDetail)(e,this.uid).catch((function(i){t.navigateTo({url:"/pages/goods_details/index?id=".concat(e.id)})}))},Changswitch:function(){this.currentPage=!1,this.is_switch=!this.is_switch},searchSubmit:function(t){this.currentPage=!1,this.$set(this.where,"keyword",t.detail.value),this.loadend=!1,this.$set(this.where,"page",1),this.getProductList(!0),this.getSearchFilter()},get_host_product:function(){var t=this;t.hotScroll||(0,n.getProductHot)(t.hotPage,t.hotLimit).then((function(e){t.hotPage++,t.hotScroll=e.data.length<t.hotLimit,t.hostProduct=t.hostProduct.concat(e.data)}))},set_where:function(e){switch(this.currentPage=!1,e){case 1:return t.navigateBack({delta:1});case 2:0==this.price?this.price=1:1==this.price?this.price=2:2==this.price&&(this.price=0),this.stock=0;break;case 3:0==this.stock?this.stock=1:1==this.stock?this.stock=2:2==this.stock&&(this.stock=0),this.price=0;break;case 4:this.nows=!this.nows;break}this.loadend=!1,this.$set(this.where,"page",1),this.getProductList(!0)},setWhere:function(){0==this.price?this.where.priceOrder="":1==this.price?this.where.priceOrder="asc":2==this.price&&(this.where.priceOrder="desc"),0==this.stock?this.where.salesOrder="":1==this.stock?this.where.salesOrder="asc":2==this.stock&&(this.where.salesOrder="desc"),this.where.news=this.nows?1:0},productslist:function(){},getProductList:function(t){var e=this,i=this;i.setWhere(),i.loadend||i.loading||(!0===t&&i.$set(i,"tempArr",[]),i.loading=!0,i.loadTitle="",(0,n.getProductslist)(i.where).then((function(t){var r=t.data,o=i.$util.SplitArray(r,i.tempArr),n=r.length<i.where.limit;i.loadend=n,i.loading=!1,i.loadTitle=n?"没有更多内容啦~":"加载更多",i.$set(i,"tempArr",o),i.$set(i.where,"page",i.where.page+1),i.tempArr.length||e.get_host_product()})).catch((function(t){i.loading=!1,i.loadTitle="加载更多"})))},getMarTop:function(){var t=this;this.promotionList.length||this.filterCateList.length?this.$nextTick((function(){t.marTop=2*(115+p)})):this.$nextTick((function(){t.marTop=2*(75+p)}))},subOrder:function(){var e=this.cartData.cartList,i=[];if(!e.length)return this.$util.Tips({title:"请选择产品"});e.forEach((function(t){t.attrStatus&&t.status&&i.push(t.id)})),t.navigateTo({url:"/pages/goods/order_confirm/index?cartId="+i.join(",")}),this.cartData.iScart=!1},goBack:function(){var e=getCurrentPages();e.length>1?t.navigateBack():t.switchTab({url:"/pages/index/index"})},ChangeClearCart:function(t){var e=this,i=e.cartData.cartList,r=[];i.forEach((function(t){r.push(t.id)})),(0,s.cartDel)(r.join(",")).then((function(t){e.$set(e.cartData,"cartList",[]),e.cartData.iScart=!1,e.discountInfo.deduction.pay_price=0,e.discountInfo.deduction.sum_price=0,e.getCartNum()}))}},onPageScroll:function(e){this.currentPage=!1,t.$emit("scroll")},onReachBottom:function(){this.tempArr.length>0?this.getProductList():this.get_host_product()},onPullDownRefresh:function(){this.tempArr.length>0?this.getProductList():this.get_host_product(),setTimeout((function(){t.stopPullDownRefresh()}),1e3)}};e.default=f}).call(this,i("df3c")["default"])},1650:function(t,e,i){"use strict";i.r(e);var r=i("0181"),o=i("da19");for(var n in o)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(n);i("93bd");var s=i("828b"),a=Object(s["a"])(o["default"],r["b"],r["c"],!1,null,"375d36ac",null,!1,r["a"],void 0);e["default"]=a.exports},"67c2":function(t,e,i){},"93bd":function(t,e,i){"use strict";var r=i("67c2"),o=i.n(r);o.a},d512:function(t,e,i){"use strict";(function(t,e){var r=i("47a9");i("f076");r(i("3240"));var o=r(i("1650"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},da19:function(t,e,i){"use strict";i.r(e);var r=i("14a9"),o=i.n(r);for(var n in r)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return r[t]}))}(n);e["default"]=o.a}},[["d512","common/runtime","common/vendor"]]]);