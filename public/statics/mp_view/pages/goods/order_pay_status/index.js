require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/order_pay_status/index"],{"14f7":function(t,e,o){"use strict";o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,o=(t._self._c,t.order_pay_info.paid&&"offline"!=t.order_pay_info.pay_type&&t.prize.length&&t.loading&&t.lotteryLoading),n=t.showGift?t.__map(t.couponList,(function(e,o){var n=t.__get_orig(e),i=parseInt(e.use_min_price>0);return{$orig:n,m0:i}})):null;t.$mp.data=Object.assign({},{$root:{g0:o,l0:n}})},i=[]},"1b0c":function(t,e,o){"use strict";(function(t){var n=o("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(o("7ca3")),a=o("606e"),r=o("7391"),c=o("df03"),d=o("0f73"),s=o("5088"),u=o("8f59"),l=n(o("89cc")),f=o("4d38");function h(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function g(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?h(Object(o),!0).forEach((function(e){(0,i.default)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):h(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var p=t.getWindowInfo().statusBarHeight,m={components:{gridsLottery:function(){Promise.all([o.e("pages/goods/common/vendor"),o.e("pages/goods/components/lottery/payLottery")]).then(function(){return resolve(o("dc6e"))}.bind(null,o)).catch(o.oe)},lotteryAleart:function(){Promise.all([o.e("common/vendor"),o.e("pages/goods/components/lotteryAleart/index")]).then(function(){return resolve(o("4b97"))}.bind(null,o)).catch(o.oe)},recommend:function(){Promise.all([o.e("common/vendor"),o.e("components/recommend/index")]).then(function(){return resolve(o("a60c"))}.bind(null,o)).catch(o.oe)}},mixins:[l.default],data:function(){return{imgHost:f.HTTP_REQUEST_URL,sysHeight:p,loading:!1,lotteryLoading:!1,orderLottery:!1,orderId:"",order_pay_info:{paid:1,_status:{}},isAuto:!1,isShowAuth:!1,status:0,msg:"",couponsHidden:!0,couponList:[],giftList:[],options:{},prize:[],datatime:0,totalPrice:0,type:"",lottery_draw_param:{startIndex:3,totalCount:3,winingIndex:1,speed:100},aleartType:0,aleartStatus:!1,addressModel:!1,lottery_num:0,alData:{},hostProduct:[],hotScroll:!1,hotPage:1,hotLimit:10,prize_integral:0,prize_exp:0}},computed:g(g({},(0,u.mapGetters)(["isLogin","cartNum"])),{},{showGift:function(){return!(!this.couponList.length&&!this.giftList.length&&0==this.prize_integral&&0==this.prize_exp)}}),watch:{isLogin:{handler:function(t,e){},deep:!0}},onLoad:function(t){if(this.options=t,!t.order_id)return this.$util.Tips({title:"缺少参数无法查看订单支付状态"},{tab:3,url:1});this.orderId=t.order_id,this.status=t.status||0,this.msg=t.msg||"",this.type=this.options.type,this.totalPrice=this.options.totalPrice,this.getLotteryData(this.type),this.getHostProduct()},onShow:function(){t.setStorageSync("form_type_cart",1),this.isLogin?this.getOrderPayInfo():(0,s.toLogin)()},methods:{moveHandle:function(){return!1},authColse:function(t){this.isShowAuth=t},openTap:function(){this.$set(this,"couponsHidden",!this.couponsHidden)},onLoadFun:function(){this.getOrderPayInfo(),this.isShowAuth=!1},getOrderPayInfo:function(){var e=this,o=this;t.showLoading({title:"正在加载中"}),(0,a.getOrderDetail)(o.orderId).then((function(n){if(t.hideLoading(),o.$set(o,"order_pay_info",n.data),t.setNavigationBarTitle({title:n.data.paid?"支付成功":"未支付"}),t.$emit("newCartNum",n.data.cartInfo),0===parseInt(t.getStorageSync("news"))){var i=e.cartNum-n.data.total_num;e.$store.commit("indexData/setCartNum",i+""),t.removeStorageSync("news")}e.loading=!0,setTimeout((function(){o.getOrderPrize()}),1e3)})).catch((function(o){e.loading=!0,t.hideLoading()}))},getOrderPrize:function(){var t=this;(0,a.getOrderPrizeApi)(this.orderId).then((function(e){t.couponList=e.data.coupons,t.giftList=e.data.gift,t.prize_integral=e.data.integral,t.prize_exp=e.data.exp}))},goIndex:function(e){t.switchTab({url:"/pages/index/index"})},goPink:function(e){t.navigateTo({url:"/pages/activity/goods_combination_status/index?id="+e})},goOrderDetails:function(e){var o=this;t.showLoading({title:"正在加载"}),(0,r.openOrderSubscribe)().then((function(e){t.hideLoading(),t.navigateTo({url:"/pages/goods/order_details/index?order_id="+o.orderId})})).catch((function(){t.hideLoading()}))},getLotteryData:function(e){var o=this;(0,c.getLotteryData)(e).then((function(e){o.factor_num=e.data.lottery.factor_num,o.id=e.data.lottery.id,o.prize=e.data.lottery.prize,o.prize.length&&o.prize.push({name:1}),o.lottery_num=e.data.lottery_num,o.lotteryLoading=!0,o.datatime=parseInt(e.data.cache_time),6==e.data.lottery.type&&t.navigateTo({url:"/pages/goods/lottery/grids/record"})})).catch((function(t){o.lotteryLoading=!1}))},getWiningIndex:function(t){var e=this;this.aleartType=0,(0,c.startLottery)({id:this.id}).then((function(o){e.prize.forEach((function(n,i){o.data.id===n.id&&(e.alData=o.data,e.lottery_draw_param.winingIndex=i,t(e.lottery_draw_param))}))})).catch((function(t){e.$util.Tips({title:t})}))},luck_draw_finish:function(t){this.aleartType=2,this.aleartStatus=!0},closeLottery:function(e){var o=this;this.aleartStatus=!1,6===this.alData.type&&(0,d.postCartAdd)({cartNum:1,new:1,is_new:1,productId:this.alData.product_id,uniqueId:this.alData.unique,luckRecordId:this.alData.lottery_record_id}).then((function(e){t.navigateTo({url:"/pages/goods/order_confirm/index?new=1&luckRecordId=".concat(o.alData.lottery_record_id,"&cartId=").concat(e.data.cartId)})})).catch((function(t){o.$util.Tips({title:"".concat(t,",请联系客服")})})),this.getLotteryData(this.type)},getHostProduct:function(){var t=this;t.hotScroll||(0,d.getProductHot)(t.hotPage,t.hotLimit).then((function(e){t.hotPage++,t.hotScroll=e.data.length<t.hotLimit,t.hostProduct=t.hostProduct.concat(e.data)}))},goPage:function(e,o){1==e?t.navigateTo({url:o}):2==e?t.switchTab({url:o}):3==e&&t.navigateBack()}},onPageScroll:function(e){t.$emit("scroll")}};e.default=m}).call(this,o("df3c")["default"])},"2cd6":function(t,e,o){"use strict";(function(t,e){var n=o("47a9");o("f076");n(o("3240"));var i=n(o("2e79"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(i.default)}).call(this,o("3223")["default"],o("df3c")["createPage"])},"2e79":function(t,e,o){"use strict";o.r(e);var n=o("14f7"),i=o("6a70");for(var a in i)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(a);o("8356");var r=o("828b"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=c.exports},"6a70":function(t,e,o){"use strict";o.r(e);var n=o("1b0c"),i=o.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a},8356:function(t,e,o){"use strict";var n=o("d370"),i=o.n(n);i.a},d370:function(t,e,o){}},[["2cd6","common/runtime","common/vendor","pages/goods/common/vendor"]]]);