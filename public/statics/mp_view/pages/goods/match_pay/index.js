require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/match_pay/index","components/productWindow/index"],{"066b":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=2*(t.getWindowInfo().windowHeight*(3/4)-238),n={props:{attr:{type:Object,default:function(){}},storeInfo:{type:Object,default:function(){}},limitNum:{type:Number,value:0},isShow:{type:Number,value:0},iSbnt:{type:Number,value:0},iSplus:{type:Number,value:0},iScart:{type:Number,value:0},is_vip:{type:Number,value:0},type:{type:[Number,String],default:0},fangda:{type:Boolean,default:!0},isExtends:{type:Boolean,default:!1},showFooter:{type:Boolean,default:!1}},data:function(){return{windowHeight:i,gridShow:1}},computed:{reduceDisabled:function(){return 0==this.type&&this.storeInfo&&this.storeInfo.min_qty?this.storeInfo.min_qty==this.attr.productSelect.cart_num:this.attr.productSelect.cart_num<=1},addDisabled:function(){return 0==this.type&&this.storeInfo&&this.storeInfo.is_limit&&this.storeInfo.limit_num?this.storeInfo.limit_num==this.attr.productSelect.cart_num:this.attr.productSelect.cart_num>=this.attr.productSelect.stock},isDisabled:function(){if(0==this.type&&(this.storeInfo.min_qty||this.storeInfo.limit_num))return!0}},methods:{toggleGridAttr:function(t){this.gridShow=t},goCat:function(){this.$emit("goCat")},bindCode:function(t){this.$emit("iptCartNum",this.attr.productSelect.cart_num)},closeAttr:function(){this.$emit("myevent")},CartNumDes:function(){this.reduceDisabled||this.$emit("ChangeCartNum",!1)},CartNumAdd:function(){this.addDisabled||this.$emit("ChangeCartNum",!0)},tapAttr:function(t,e){this.$emit("attrVal",{indexw:t,indexn:e}),this.$set(this.attr.productAttr[t],"index",this.attr.productAttr[t].attr_values[e]);var i=this.getCheckedValue().join(",");this.$emit("ChangeAttr",i)},getCheckedValue:function(){for(var t=this.attr.productAttr,e=[],i=0;i<t.length;i++)for(var n=0;n<t[i].attr_values.length;n++)t[i].index===t[i].attr_values[n]&&e.push(t[i].attr_values[n]);return e},showImg:function(){this.$emit("getImg")},cartConfirm:function(){this.$emit("onConfirm")},proviewImg:function(e){t.previewImage({current:0,urls:[e]})}}};e.default=n}).call(this,i("df3c")["default"])},"3c32":function(t,e,i){"use strict";i.r(e);var n=i("b4ea"),r=i.n(n);for(var u in n)["default"].indexOf(u)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(u);e["default"]=r.a},7351:function(t,e,i){"use strict";var n=i("c2cf"),r=i.n(n);r.a},"86a5":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){}));var n=function(){var t=this.$createElement;this._self._c},r=[]},"88ce":function(t,e,i){"use strict";i.r(e);var n=i("066b"),r=i.n(n);for(var u in n)["default"].indexOf(u)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(u);e["default"]=r.a},"96f3":function(t,e,i){},"9ebc":function(t,e,i){"use strict";var n=i("96f3"),r=i.n(n);r.a},b04f:function(t,e,i){"use strict";i.r(e);var n=i("86a5"),r=i("3c32");for(var u in r)["default"].indexOf(u)<0&&function(t){i.d(e,t,(function(){return r[t]}))}(u);i("7351");var a=i("828b"),c=Object(a["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=c.exports},b3a2:function(t,e,i){"use strict";(function(t,e){var n=i("47a9");i("f076");n(i("3240"));var r=n(i("b04f"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(r.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},b4ea:function(t,e,i){"use strict";(function(t){var n=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i("0f73"),u=n(i("89cc")),a=(n(i("bae9")),t.getWindowInfo().statusBarHeight),c={data:function(){return{statusBarHeight:a,id:0,params:{page:1,limit:20},discountsData:[],selectValue:[],selectAttr:[],loading:!1,attr:{cartAttr:!1,productAttr:[],productSelect:{}},productValue:[],index:0,indexn:0,visible:!1}},components:{baseDrawer:function(){i.e("components/tui-drawer/tui-drawer").then(function(){return resolve(i("af01"))}.bind(null,i)).catch(i.oe)}},mixins:[u.default],onLoad:function(t){this.id=t.id?t.id:0,this.getList()},methods:{getList:function(){var e=this;this.loading||(this.loading=!0,(0,r.matchPayListApi)(this.id,this.params).then((function(i){if(e.loading=!1,!i.data.length)return t.navigateBack({delta:1});i.data.map((function(t,i){e.$set(t,"totalPrice",0),t.products.map((function(i,n){var r=e.DefaultSelect(i);Object.assign(i,r),t.type?(e.$set(i,"select",0==n),e.$set(t,"totalPrice",Number(t.products[0].price))):(e.$set(i,"select",!0),t.totalPrice+=Number(i.price))}))})),e.discountsData=e.discountsData.concat(i.data),e.params.page=e.params.page+1})).catch((function(t){e.$util.Tips({title:t})})))},backPage:function(){t.navigateBack()},checkPro:function(t,e,i){if(!i.type)return this.$util.Tips({title:"本套餐为固定套餐,不可更改"});if(i.type&&0==e)return this.$util.Tips({title:"套餐主商品不可取消"});if(t.select=!t.select,t.select)i.totalPrice=(Number(i.totalPrice)+Number(t.price)).toFixed(2);else{i.totalPrice=(Number(i.totalPrice)-Number(t.price)).toFixed(2);this.selectValue.findIndex((function(e){return e==t.id}))}},tapAttr:function(t,e){var i=this;this.$set(this.attr.productAttr[t],"index",this.attr.productAttr[t].attr_values[e]);var n=this.getCheckedValue().join(","),r={price:this.productValue[n].price,unique:this.productValue[n].unique||"",suk:this.productValue[n].suk||"默认"};this.attr.productSelect={price:this.productValue[n].price,image:this.productValue[n].image,stock:this.productValue[n].stock},this.$nextTick((function(){Object.assign(i.discountsData[i.index].products[i.indexn],r);for(var t=0,e=0;e<i.discountsData[i.index].products.length;e++)t+=parseFloat(i.discountsData[i.index].products[e].price);i.$set(i.discountsData[i.index],"totalPrice",t)}))},getCheckedValue:function(){for(var t=this.attr.productAttr,e=[],i=0;i<t.length;i++)for(var n=0;n<t[i].attr_values.length;n++)t[i].index===t[i].attr_values[n]&&e.push(t[i].attr_values[n]);return e},DefaultSelect:function(t){t.productAttr;var e=[],i=[];for(var n in t.productValue)i.push(t.productValue[n].price);var r=Math.min.apply(null,i);for(var n in t.productValue)if(t.productValue[n].product_stock>0&&t.productValue[n].price==r){e=t.productAttr.length?n.split(","):[];break}for(var u=0;u<t.productAttr.length;u++)this.$set(t.productAttr[u],"index",e[u]);var a=t.productValue[e.join(",")],c={price:a.price,unique:a.unique||"",suk:a.suk||"默认",stock:a.stock};return c},closeDrawer:function(){this.visible=!1},selecAttr:function(t,e,i){this.index=e,this.indexn=i,this.productValue=t.productValue,this.attr={productAttr:t.productAttr,productSelect:{price:t.price,image:t.image,stock:t.stock}},this.visible=!0},subData:function(e){var i=this,n={new:1,discountId:e.id,discountInfos:[]},u=0;if(e.products.forEach((function(t,e){t.select&&(u++,n.discountInfos.push({id:t.id,unique:t.unique,product_id:t.product_id}))})),u<2)return this.$util.Tips({title:"请先选择套餐商品"});(0,r.postCartAdd)(n).then((function(e){t.navigateTo({url:"/pages/goods/order_confirm/index?new=1&noCoupon=1&cartId="+e.data.cartId.join(",")})})).catch((function(t){return i.$util.Tips({title:t})}))}}};e.default=c}).call(this,i("df3c")["default"])},bae9:function(t,e,i){"use strict";i.r(e);var n=i("d798"),r=i("88ce");for(var u in r)["default"].indexOf(u)<0&&function(t){i.d(e,t,(function(){return r[t]}))}(u);i("9ebc");var a=i("828b"),c=Object(a["a"])(r["default"],n["b"],n["c"],!1,null,"f5ca5110",null,!1,n["a"],void 0);e["default"]=c.exports},c2cf:function(t,e,i){},d798:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){}));var n=function(){var t=this.$createElement;this._self._c},r=[]}},[["b3a2","common/runtime","common/vendor"]]]);